<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
    <head>
        <meta charset="utf-8" />
        <meta name="generator" content="markdown-it" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
        <meta name="author" content="runner" />
        <meta name="dcterms.date" content="2025-04-08 13:44:53.536" />
        <title>file_search_replace</title>
        <style type="text/css">
            code {
                white-space: pre-wrap;
            }
            span.smallcaps {
                font-variant: small-caps;
            }
            span.underline {
                text-decoration: underline;
            }
            div.column {
                display: inline-block;
                vertical-align: top;
                width: 50%;
            }
        </style>
        <style type="text/css">
            a.sourceLine {
                display: inline-block;
                line-height: 1.25;
            }
            a.sourceLine {
                pointer-events: none;
                color: inherit;
                text-decoration: inherit;
            }
            a.sourceLine:empty {
                height: 1.2em;
            }
            .sourceCode {
                overflow: visible;
            }
            code.sourceCode {
                white-space: pre;
                position: relative;
            }
            div.sourceCode {
                margin: 1em 0;
            }
            pre.sourceCode {
                margin: 0;
            }
            @media screen {
                div.sourceCode {
                    overflow: auto;
                }
            }
            @media print {
                code.sourceCode {
                    white-space: pre-wrap;
                }
                a.sourceLine {
                    text-indent: -1em;
                    padding-left: 1em;
                }
            }
            pre.numberSource a.sourceLine {
                position: relative;
                left: -4em;
            }
            pre.numberSource a.sourceLine::before {
                content: attr(title);
                position: relative;
                left: -1em;
                text-align: right;
                vertical-align: baseline;
                border: none;
                pointer-events: all;
                display: inline-block;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                padding: 0 4px;
                width: 4em;
                background-color: #ffffff;
                color: #a0a0a0;
            }
            pre.numberSource {
                margin-left: 3em;
                border-left: 1px solid #a0a0a0;
                padding-left: 4px;
            }
            div.sourceCode {
                color: #1f1c1b;
                background-color: #ffffff;
            }
            @media screen {
                a.sourceLine::before {
                    text-decoration: underline;
                }
            }
            code span {
                color: #1f1c1b;
            } /* Normal */
            code span.al {
                color: #bf0303;
                background-color: #f7e6e6;
                font-weight: bold;
            } /* Alert */
            code span.an {
                color: #ca60ca;
            } /* Annotation */
            code span.at {
                color: #0057ae;
            } /* Attribute */
            code span.bn {
                color: #b08000;
            } /* BaseN */
            code span.bu {
                color: #644a9b;
                font-weight: bold;
            } /* BuiltIn */
            code span.cf {
                color: #1f1c1b;
                font-weight: bold;
            } /* ControlFlow */
            code span.ch {
                color: #924c9d;
            } /* Char */
            code span.cn {
                color: #aa5500;
            } /* Constant */
            code span.co {
                color: #898887;
            } /* Comment */
            code span.cv {
                color: #0095ff;
            } /* CommentVar */
            code span.do {
                color: #607880;
            } /* Documentation */
            code span.dt {
                color: #0057ae;
            } /* DataType */
            code span.dv {
                color: #b08000;
            } /* DecVal */
            code span.er {
                color: #bf0303;
                text-decoration: underline;
            } /* Error */
            code span.ex {
                color: #0095ff;
                font-weight: bold;
            } /* Extension */
            code span.fl {
                color: #b08000;
            } /* Float */
            code span.fu {
                color: #644a9b;
            } /* Function */
            code span.im {
                color: #ff5500;
            } /* Import */
            code span.in {
                color: #b08000;
            } /* Information */
            code span.kw {
                color: #1f1c1b;
                font-weight: bold;
            } /* Keyword */
            code span.op {
                color: #1f1c1b;
            } /* Operator */
            code span.ot {
                color: #006e28;
            } /* Other */
            code span.pp {
                color: #006e28;
            } /* Preprocessor */
            code span.re {
                color: #0057ae;
                background-color: #e0e9f8;
            } /* RegionMarker */
            code span.sc {
                color: #3daee9;
            } /* SpecialChar */
            code span.ss {
                color: #ff5500;
            } /* SpecialString */
            code span.st {
                color: #bf0303;
            } /* String */
            code span.va {
                color: #0057ae;
            } /* Variable */
            code span.vs {
                color: #bf0303;
            } /* VerbatimString */
            code span.wa {
                color: #bf0303;
            } /* Warning */
        </style>
        <!--
  Firefox non carica font da locale quindi il font puÃ² non essere visibile
  quando di carica la pagina da locale.
  Bisogna impostare about:config
    security.fileuri.strict_origin_policy = false
  -->
        <link rel="stylesheet" href="../../inc/css/katex.min.css" />
        <link rel="stylesheet" href="../../inc/css/fonts/google_fonts.css" />
        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"> -->
        <link rel="stylesheet" href="../../inc/css/bootstrap.min.css" />
        <link rel="stylesheet" href="../../inc/css/cdp.css" />
        <!--[if lt IE 9]>
            <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <![endif]-->
        <meta name="keywords" content="Appunti,Note" />
        <meta name="description" content="Appunti di runner" />
        <link rel="icon" type="image/x-icon" href="../../inc/img/favicon.ico" />
        <link rel="shortcut icon" type="image/x-icon" href="../../inc/img/favicon.ico" />

        <link rel="stylesheet" href="../../inc/js/hljs/styles/default.css" />
        <script src="../../inc/js/hljs/lib/highlight.js"></script>
        <script src="../../inc/js/bootstrap/bootstrap.bundle.min.js"></script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script> -->
        <script>
            hljs.initHighlightingOnLoad();
        </script>
        <script type="module">
            import mermaid from '../../inc/js/mermaid/dist/mermaid.esm.min.mjs';
            // import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
            mermaid.initialize({ startOnLoad: true });
        </script>
    </head>
    <body></body>
</html>
<h1 id="file_search_replace" tabindex="-1">file_search_replace <a class="header-anchor" href="#file_search_replace" aria-hidden="true">ðŸ”—</a></h1>
<p class="code">2025-04-08 13:44:53.536</p>
<nav class="table-of-contents"><ol><li><a href="#search-%26-replace-in-files">Search &amp; Replace in files </a><ol><li><a href="#cercare-tutti-i-file-.py-e-.properties-e-sostituirvi-all'interno-ogni-occorrenza-di-rb_host-con-rb_host%40prmlx006">Cercare tutti i file .py e .properties e sostituirvi all&#39;interno ogni occorrenza di RB_HOST con RB_HOST@prmlx006 </a></li></ol></li></ol></nav><h1 id="search-%26-replace-in-files" tabindex="-1">Search &amp; Replace in Files <a class="header-anchor" href="#search-%26-replace-in-files" aria-hidden="true">ðŸ”—</a></h1>
<p>Search and Replace</p>
<pre><code>grep

-E, --extended-regexp
            Interpret PATTERNS as extended regular expressions (EREs, see below).

-P, --perl-regexp
            Interpret  I&lt;PATTERNS&gt;  as  Perl-compatible  regular expressions (PCREs).  This option is experimental when combined with the -z (--null-data) option, and
            grep -P may warn of unimplemented features.

-l, --files-with-matches
            Suppress normal output; instead print the name of each input file from which output would normally have been printed.  Scanning each input file stops upon
            first match.
-Z, --null
            Output  a zero byte (the ASCII NUL character) instead of the character that normally follows a file name.  For example, grep -lZ outputs a zero byte after
            each file name instead of the usual newline.  This option makes the output unambiguous, even in the presence of file names containing  unusual  characters
            like  newlines.   This option can be used with commands like find -print0, perl -0, sort -z, and xargs -0 to process arbitrary file names, even those that
            contain newline characters.

-R, -r, --recursive
            Read all files under each directory, recursively, following symbolic links only if they are on the command line.  Note that if no file operand  is  given,
            B&lt;grep&gt; searches the working directory.  This is equivalent to the -d recurse option.

-i, --ignore-case
            Ignore case distinctions in both the PATTERN and the input files. (-i is specified by POSIX .) 

-I          Process a binary file as if it did not contain matching data; this is equivalent to the --binary-files=without-match option.            

--include=GLOB
    Search only files whose base name matches GLOB


xargs

-r, --no-run-if-empty If the standard input does not contain any nonblanks, do not run the command.  
                      Normally, the command is run once even if there is no input.  This option is a GNU extension.    

-0, --null  Input items are terminated by a null character instead of by whitespace, and the quotes and backslash are not
            special (every character is taken literally).  Disables the end of file string, which is treated like any other
            argument.  Useful when input items might contain white space, quote marks, or backslashes.  The GNU find -print0
            option produces input suitable for this mode.


sed

-i[SUFFIX], --in-place[=SUFFIX] edit files in place (makes backup if SUFFIX supplied)
-E, -r, --regexp-extended use extended regular expressions in the script (for portability use POSIX -E).    
</code></pre>
<pre><code class="language-bash"><span class="hljs-comment"># Reimposta alla data corrente le linee contenenti __date__ nei file .py e .md</span>
DATE=$(<span class="hljs-built_in">date</span> -Iminutes)
grep -rlZIE --include=\*.{py,md}  <span class="hljs-string">&#x27;^__date__&#x27;</span> . | xargs -r0 sed -i -r <span class="hljs-string">&quot;/^__date__/c\__date__=&#x27;<span class="hljs-variable">$DATE</span>&#x27;&quot;</span>
</code></pre>
<pre><code class="language-bash"><span class="hljs-comment"># Find &amp; Replace in Multiple Files</span>
<span class="hljs-comment"># -Z di grep produce un  carattere null per separare i nomi dei files, elimina il problema dei nomi di files contenente spazi</span>
<span class="hljs-comment"># -0 di xargs legge delle stringhe separate da null</span>
$ grep -rlZIE --include=\*.{py,pl,sh}  <span class="hljs-string">&quot;old_string&quot;</span> . | xargs -r0 sed -ir <span class="hljs-string">&#x27;s/old_string/new_string/g&#x27;</span>
</code></pre>
<h2 id="search-%26-replace-in-files-1" tabindex="-1">Search &amp; Replace in files <a class="header-anchor" href="#search-%26-replace-in-files-1" aria-hidden="true">ðŸ”—</a></h2>
<p>Search and Replace</p>
<pre><code class="language-bash">
$ grep -rlZ <span class="hljs-string">&quot;/media&quot;</span> . | awk <span class="hljs-string">&#x27;BEGIN {RS=&quot;\0&quot;};{print &quot;sed -i \47s/media/mnt/g\47 &quot;$0}&#x27;</span> &gt; doreplace.sh
<span class="hljs-comment"># -Z  produce un  carattere null per separare i nomi dei files, elimina il problema dei nomi di files contenente spazi</span>
<span class="hljs-comment"># RS=&quot;\0&quot; di awk legge delle stringhe separate da NUL</span>
<span class="hljs-comment"># (\47 e&#x27; il codice ottale dell&#x27;apice: &#x27;</span>

$ find ./ -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;sync*&quot;</span> -<span class="hljs-built_in">exec</span> sed -i <span class="hljs-string">&#x27;s/string1/string2/gI&#x27;</span> {} \;

<span class="hljs-comment"># Rimozione di una password da tutti i file che la contengono</span>
$ grep -rlZE <span class="hljs-string">&#x27;xxxxxxxx&#x27;</span> . | xargs -r -0 sed -i -r <span class="hljs-string">&#x27;s/xxxxxxxx/password/g&#x27;</span>

$ find . -name <span class="hljs-string">&quot;*.htm*&quot;</span> -print0 | xargs -r0 -l1 sed <span class="hljs-string">&#x27;s/.WMF/.png/g&#x27;</span> -i
<span class="hljs-comment"># oppure</span>
$ find . -name <span class="hljs-string">&quot;*.htm&quot;</span> |awk <span class="hljs-string">&#x27;{print &quot;sed \47s/.WMF/.png/g\47 &quot;$1&quot;&gt;&quot;$1&quot;.new;mv &quot;$1&quot;.new &quot; $1}&#x27;</span>&gt; dorename.sh
</code></pre>
<pre><code>grep
-r, --recursive Read  all  files under each directory, recursively
-l, --files-with-matches Suppress normal output; instead print the name of each input file from which output would normally have been printed.
-Z, --null Output a zero byte (the ASCII NUL character) instead of the character that normally follows a file name.  For example, grep -lZ outputs a zero byte after each file name instead of  the  usual newline.
-E, --extended-regexp Interpret PATTERNS as extended regular expressions

xargs
-r, --no-run-if-empty If the standard input does not contain any nonblanks, do not run the command.
-0, --null Input items are terminated by a null character instead of by whitespace

sed
-i[SUFFIX], --in-place[=SUFFIX] edit files in place (makes backup if SUFFIX supplied)
-E, -r, --regexp-extended use extended regular expressions in the script
</code></pre>
<p>al posto di <code>xargs</code> si puÃ² usare <a href="../shell/parallel.html">parallel</a></p>
<h3 id="cercare-tutti-i-file-.py-e-.properties-e-sostituirvi-all'interno-ogni-occorrenza-di-rb_host-con-rb_host%40prmlx006" tabindex="-1">Cercare tutti i file .py e .properties e sostituirvi all'interno ogni occorrenza di RB_HOST con RB_HOST@prmlx006 <a class="header-anchor" href="#cercare-tutti-i-file-.py-e-.properties-e-sostituirvi-all'interno-ogni-occorrenza-di-rb_host-con-rb_host%40prmlx006" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-bash">find . -name <span class="hljs-string">&quot;*.py&quot;</span> -o -name <span class="hljs-string">&quot;*.properties&quot;</span>| awk <span class="hljs-string">&#x27;{print &quot;sed \47s/RB_HOST/RBHOST\100prmlx006/g\47 &quot;$1&quot;&gt;&quot;$1&quot;.new;mv &quot;$1&quot;.new &quot; $1}&#x27;</span>&gt; dorename.sh
<span class="hljs-comment">#(\47 e&#x27; il codice ottale dell&#x27;apice: &#x27;</span>
<span class="hljs-comment">#\100 e&#x27; il codice ottale della chiocciola:@</span>
<span class="hljs-comment">#)</span>
</code></pre>
</body></html>