<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
    <head>
        <meta charset="utf-8" />
        <meta name="generator" content="markdown-it" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
        <meta name="author" content="runner" />
        <meta name="dcterms.date" content="2025-04-09 13:28:34.231" />
        <title>run</title>
        <style type="text/css">
            code {
                white-space: pre-wrap;
            }
            span.smallcaps {
                font-variant: small-caps;
            }
            span.underline {
                text-decoration: underline;
            }
            div.column {
                display: inline-block;
                vertical-align: top;
                width: 50%;
            }
        </style>
        <style type="text/css">
            a.sourceLine {
                display: inline-block;
                line-height: 1.25;
            }
            a.sourceLine {
                pointer-events: none;
                color: inherit;
                text-decoration: inherit;
            }
            a.sourceLine:empty {
                height: 1.2em;
            }
            .sourceCode {
                overflow: visible;
            }
            code.sourceCode {
                white-space: pre;
                position: relative;
            }
            div.sourceCode {
                margin: 1em 0;
            }
            pre.sourceCode {
                margin: 0;
            }
            @media screen {
                div.sourceCode {
                    overflow: auto;
                }
            }
            @media print {
                code.sourceCode {
                    white-space: pre-wrap;
                }
                a.sourceLine {
                    text-indent: -1em;
                    padding-left: 1em;
                }
            }
            pre.numberSource a.sourceLine {
                position: relative;
                left: -4em;
            }
            pre.numberSource a.sourceLine::before {
                content: attr(title);
                position: relative;
                left: -1em;
                text-align: right;
                vertical-align: baseline;
                border: none;
                pointer-events: all;
                display: inline-block;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                padding: 0 4px;
                width: 4em;
                background-color: #ffffff;
                color: #a0a0a0;
            }
            pre.numberSource {
                margin-left: 3em;
                border-left: 1px solid #a0a0a0;
                padding-left: 4px;
            }
            div.sourceCode {
                color: #1f1c1b;
                background-color: #ffffff;
            }
            @media screen {
                a.sourceLine::before {
                    text-decoration: underline;
                }
            }
            code span {
                color: #1f1c1b;
            } /* Normal */
            code span.al {
                color: #bf0303;
                background-color: #f7e6e6;
                font-weight: bold;
            } /* Alert */
            code span.an {
                color: #ca60ca;
            } /* Annotation */
            code span.at {
                color: #0057ae;
            } /* Attribute */
            code span.bn {
                color: #b08000;
            } /* BaseN */
            code span.bu {
                color: #644a9b;
                font-weight: bold;
            } /* BuiltIn */
            code span.cf {
                color: #1f1c1b;
                font-weight: bold;
            } /* ControlFlow */
            code span.ch {
                color: #924c9d;
            } /* Char */
            code span.cn {
                color: #aa5500;
            } /* Constant */
            code span.co {
                color: #898887;
            } /* Comment */
            code span.cv {
                color: #0095ff;
            } /* CommentVar */
            code span.do {
                color: #607880;
            } /* Documentation */
            code span.dt {
                color: #0057ae;
            } /* DataType */
            code span.dv {
                color: #b08000;
            } /* DecVal */
            code span.er {
                color: #bf0303;
                text-decoration: underline;
            } /* Error */
            code span.ex {
                color: #0095ff;
                font-weight: bold;
            } /* Extension */
            code span.fl {
                color: #b08000;
            } /* Float */
            code span.fu {
                color: #644a9b;
            } /* Function */
            code span.im {
                color: #ff5500;
            } /* Import */
            code span.in {
                color: #b08000;
            } /* Information */
            code span.kw {
                color: #1f1c1b;
                font-weight: bold;
            } /* Keyword */
            code span.op {
                color: #1f1c1b;
            } /* Operator */
            code span.ot {
                color: #006e28;
            } /* Other */
            code span.pp {
                color: #006e28;
            } /* Preprocessor */
            code span.re {
                color: #0057ae;
                background-color: #e0e9f8;
            } /* RegionMarker */
            code span.sc {
                color: #3daee9;
            } /* SpecialChar */
            code span.ss {
                color: #ff5500;
            } /* SpecialString */
            code span.st {
                color: #bf0303;
            } /* String */
            code span.va {
                color: #0057ae;
            } /* Variable */
            code span.vs {
                color: #bf0303;
            } /* VerbatimString */
            code span.wa {
                color: #bf0303;
            } /* Warning */
        </style>
        <!--
  Firefox non carica font da locale quindi il font puÃ² non essere visibile
  quando di carica la pagina da locale.
  Bisogna impostare about:config
    security.fileuri.strict_origin_policy = false
  -->
        <link rel="stylesheet" href="../../../../../inc/css/katex.min.css" />
        <link rel="stylesheet" href="../../../../../inc/css/fonts/google_fonts.css" />
        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"> -->
        <link rel="stylesheet" href="../../../../../inc/css/bootstrap.min.css" />
        <link rel="stylesheet" href="../../../../../inc/css/cdp.css" />
        <!--[if lt IE 9]>
            <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <![endif]-->
        <meta name="keywords" content="Appunti,Note" />
        <meta name="description" content="Appunti di runner" />
        <link rel="icon" type="image/x-icon" href="../../../../../inc/img/favicon.ico" />
        <link rel="shortcut icon" type="image/x-icon" href="../../../../../inc/img/favicon.ico" />

        <link rel="stylesheet" href="../../../../../inc/js/hljs/styles/default.css" />
        <script src="../../../../../inc/js/hljs/lib/highlight.js"></script>
        <script src="../../../../../inc/js/bootstrap/bootstrap.bundle.min.js"></script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script> -->
        <script>
            hljs.initHighlightingOnLoad();
        </script>
        <script type="module">
            import mermaid from '../../../../../inc/js/mermaid/dist/mermaid.esm.min.mjs';
            // import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
            mermaid.initialize({ startOnLoad: true });
        </script>
    </head>
    <body></body>
</html>
<h1 id="run" tabindex="-1">run <a class="header-anchor" href="#run" aria-hidden="true">ðŸ”—</a></h1>
<p class="code">2025-04-09 13:28:34.231</p>
<nav class="table-of-contents"><ol><li><a href="#title%3A-%22run%22description%3A-%22the-run-command-description-and-usage%22keywords%3A-%22run%2C-command%2C-container%22">title: &quot;run&quot;description: &quot;The run command description and usage&quot;keywords: &quot;run, command, container&quot; </a></li><li><a href="#description">Description </a></li><li><a href="#examples">Examples </a><ol><li><a href="#assign-name-and-allocate-pseudo-tty-(--name%2C--it)">Assign name and allocate pseudo-TTY (--name, -it) </a></li><li><a href="#capture-container-id-(--cidfile)">Capture container ID (--cidfile) </a></li><li><a href="#full-container-capabilities-(--privileged)">Full container capabilities (--privileged) </a></li><li><a href="#set-working-directory-(-w)">Set working directory (-w) </a></li><li><a href="#set-storage-driver-options-per-container">Set storage driver options per container </a></li><li><a href="#mount-tmpfs-(--tmpfs)">Mount tmpfs (--tmpfs) </a></li><li><a href="#mount-volume-(-v%2C---read-only)">Mount volume (-v, --read-only) </a></li><li><a href="#add-bind-mounts-or-volumes-using-the---mount-flag">Add bind mounts or volumes using the --mount flag </a></li><li><a href="#publish-or-expose-port-(-p%2C---expose)">Publish or expose port (-p, --expose) </a></li><li><a href="#set-environment-variables-(-e%2C---env%2C---env-file)">Set environment variables (-e, --env, --env-file) </a></li><li><a href="#set-metadata-on-container-(-l%2C---label%2C---label-file)">Set metadata on container (-l, --label, --label-file) </a></li><li><a href="#connect-a-container-to-a-network-(--network)">Connect a container to a network (--network) </a></li><li><a href="#mount-volumes-from-container-(--volumes-from)">Mount volumes from container (--volumes-from) </a></li><li><a href="#attach-to-stdin%2Fstdout%2Fstderr-(-a)">Attach to STDIN/STDOUT/STDERR (-a) </a></li><li><a href="#add-host-device-to-container-(--device)">Add host device to container (--device) </a></li><li><a href="#access-an-nvidia-gpu">Access an NVIDIA GPU </a></li><li><a href="#restart-policies-(--restart)">Restart policies (--restart) </a></li><li><a href="#add-entries-to-container-hosts-file-(--add-host)">Add entries to container hosts file (--add-host) </a></li><li><a href="#set-ulimits-in-container-(--ulimit)">Set ulimits in container (--ulimit) </a><ol><li><a href="#for-nproc-usage">For nproc usage </a></li></ol></li><li><a href="#stop-container-with-signal-(--stop-signal)">Stop container with signal (--stop-signal) </a></li><li><a href="#optional-security-options-(--security-opt)">Optional security options (--security-opt) </a></li><li><a href="#stop-container-with-timeout-(--stop-timeout)">Stop container with timeout (--stop-timeout) </a></li><li><a href="#specify-isolation-technology-for-container-(--isolation)">Specify isolation technology for container (--isolation) </a></li><li><a href="#specify-hard-limits-on-memory-available-to-containers-(-m%2C---memory)">Specify hard limits on memory available to containers (-m, --memory) </a></li><li><a href="#configure-namespaced-kernel-parameters-(sysctls)-at-runtime">Configure namespaced kernel parameters (sysctls) at runtime </a><ol><li><a href="#currently-supported-sysctls">Currently supported sysctls </a></li></ol></li></ol></li></ol></nav><hr>
<h2 id="title%3A-%22run%22description%3A-%22the-run-command-description-and-usage%22keywords%3A-%22run%2C-command%2C-container%22" tabindex="-1">title: &quot;run&quot;
description: &quot;The run command description and usage&quot;
keywords: &quot;run, command, container&quot; <a class="header-anchor" href="#title%3A-%22run%22description%3A-%22the-run-command-description-and-usage%22keywords%3A-%22run%2C-command%2C-container%22" aria-hidden="true">ðŸ”—</a></h2>
<h1 id="run-1" tabindex="-1">run <a class="header-anchor" href="#run-1" aria-hidden="true">ðŸ”—</a></h1>
<pre><code class="language-markdown">Usage:  docker run [OPTIONS] IMAGE [COMMAND] [ARG...]

Run a command in a new container

Options:
<span class="hljs-code">      --add-host value                Add a custom host-to-IP mapping (host:ip) (default [])
  -a, --attach value                  Attach to STDIN, STDOUT or STDERR (default [])
      --blkio-weight value            Block IO (relative weight), between 10 and 1000
      --blkio-weight-device value     Block IO weight (relative device weight) (default [])
      --cap-add value                 Add Linux capabilities (default [])
      --cap-drop value                Drop Linux capabilities (default [])
      --cgroupns string               Cgroup namespace to use
                                      &#x27;host&#x27;:    Run the container in the Docker host&#x27;s cgroup namespace
                                      &#x27;private&#x27;: Run the container in its own private cgroup namespace
                                      &#x27;&#x27;:        Use the default Docker daemon cgroup namespace specified by the `--default-cgroupns-mode` option
      --cgroup-parent string          Optional parent cgroup for the container
      --cidfile string                Write the container ID to the file
      --cpu-count int                 The number of CPUs available for execution by the container.
                                      Windows daemon only. On Windows Server containers, this is
                                      approximated as a percentage of total CPU usage.
      --cpu-percent int               Limit percentage of CPU available for execution
                                      by the container. Windows daemon only.
                                      The processor resource controls are mutually
                                      exclusive, the order of precedence is CPUCount
                                      first, then CPUShares, and CPUPercent last.
      --cpu-period int                Limit CPU CFS (Completely Fair Scheduler) period
      --cpu-quota int                 Limit CPU CFS (Completely Fair Scheduler) quota
  -c, --cpu-shares int                CPU shares (relative weight)
      --cpus NanoCPUs                 Number of CPUs (default 0.000)
      --cpu-rt-period int             Limit the CPU real-time period in microseconds
      --cpu-rt-runtime int            Limit the CPU real-time runtime in microseconds
      --cpuset-cpus string            CPUs in which to allow execution (0-3, 0,1)
      --cpuset-mems string            MEMs in which to allow execution (0-3, 0,1)
  -d, --detach                        Run container in background and print container ID
      --detach-keys string            Override the key sequence for detaching a container
      --device value                  Add a host device to the container (default [])
      --device-cgroup-rule value      Add a rule to the cgroup allowed devices list
      --device-read-bps value         Limit read rate (bytes per second) from a device (default [])
      --device-read-iops value        Limit read rate (IO per second) from a device (default [])
      --device-write-bps value        Limit write rate (bytes per second) to a device (default [])
      --device-write-iops value       Limit write rate (IO per second) to a device (default [])
      --disable-content-trust         Skip image verification (default true)
      --dns value                     Set custom DNS servers (default [])
      --dns-option value              Set DNS options (default [])
      --dns-search value              Set custom DNS search domains (default [])
      --domainname string             Container NIS domain name
      --entrypoint string             Overwrite the default ENTRYPOINT of the image
  -e, --env value                     Set environment variables (default [])
      --env-file value                Read in a file of environment variables (default [])
      --expose value                  Expose a port or a range of ports (default [])
      --group-add value               Add additional groups to join (default [])
      --health-cmd string             Command to run to check health
      --health-interval duration      Time between running the check (ns|us|ms|s|m|h) (default 0s)
      --health-retries int            Consecutive failures needed to report unhealthy
      --health-timeout duration       Maximum time to allow one check to run (ns|us|ms|s|m|h) (default 0s)
      --health-start-period duration  Start period for the container to initialize before counting retries towards unstable (ns|us|ms|s|m|h) (default 0s)
      --help                          Print usage
  -h, --hostname string               Container host name
      --init                          Run an init inside the container that forwards signals and reaps processes
  -i, --interactive                   Keep STDIN open even if not attached
      --io-maxbandwidth string        Maximum IO bandwidth limit for the system drive (Windows only)
                                      (Windows only). The format is `&lt;number&gt;&lt;unit&gt;`.
                                      Unit is optional and can be `b` (bytes per second),
                                      `k` (kilobytes per second), `m` (megabytes per second),
                                      or `g` (gigabytes per second). If you omit the unit,
                                      the system uses bytes per second.
                                      --io-maxbandwidth and --io-maxiops are mutually exclusive options.
      --io-maxiops uint               Maximum IOps limit for the system drive (Windows only)
      --ip string                     IPv4 address (e.g., 172.30.100.104)
      --ip6 string                    IPv6 address (e.g., 2001:db8::33)
      --ipc string                    IPC namespace to use
      --isolation string              Container isolation technology
      --kernel-memory string          Kernel memory limit
  -l, --label value                   Set meta data on a container (default [])
      --label-file value              Read in a line delimited file of labels (default [])
      --link value                    Add link to another container (default [])
      --link-local-ip value           Container IPv4/IPv6 link-local addresses (default [])
      --log-driver string             Logging driver for the container
      --log-opt value                 Log driver options (default [])
      --mac-address string            Container MAC address (e.g., 92:d0:c6:0a:29:33)
  -m, --memory string                 Memory limit
      --memory-reservation string     Memory soft limit
      --memory-swap string            Swap limit equal to memory plus swap: &#x27;-1&#x27; to enable unlimited swap
      --memory-swappiness int         Tune container memory swappiness (0 to 100) (default -1)
      --mount value                   Attach a filesystem mount to the container (default [])
      --name string                   Assign a name to the container
      --network-alias value           Add network-scoped alias for the container (default [])
      --network string                Connect a container to a network
                                      &#x27;bridge&#x27;: create a network stack on the default Docker bridge
                                      &#x27;none&#x27;: no networking
                                      &#x27;container:&lt;name|id&gt;&#x27;: reuse another container&#x27;s network stack
                                      &#x27;host&#x27;: use the Docker host network stack
                                      &#x27;&lt;network-name&gt;|&lt;network-id&gt;&#x27;: connect to a user-defined network
      --no-healthcheck                Disable any container-specified HEALTHCHECK
      --oom-kill-disable              Disable OOM Killer
      --oom-score-adj int             Tune host&#x27;s OOM preferences (-1000 to 1000)
      --pid string                    PID namespace to use
      --pids-limit int                Tune container pids limit (set -1 for unlimited)
      --privileged                    Give extended privileges to this container
  -p, --publish value                 Publish a container&#x27;s port(s) to the host (default [])
  -P, --publish-all                   Publish all exposed ports to random ports
      --read-only                     Mount the container&#x27;s root filesystem as read only
      --restart string                Restart policy to apply when a container exits (default &quot;no&quot;)
                                      Possible values are : no, on-failure[:max-retry], always, unless-stopped
      --rm                            Automatically remove the container when it exits
      --runtime string                Runtime to use for this container
      --security-opt value            Security Options (default [])
      --shm-size bytes                Size of /dev/shm
                                      The format is `&lt;number&gt;&lt;unit&gt;`. `number` must be greater than `0`.
                                      Unit is optional and can be `b` (bytes), `k` (kilobytes), `m` (megabytes),
                                      or `g` (gigabytes). If you omit the unit, the system uses bytes.
      --sig-proxy                     Proxy received signals to the process (default true)
      --stop-signal string            Signal to stop the container
      --stop-timeout int              Timeout (in seconds) to stop a container
      --storage-opt value             Storage driver options for the container (default [])
      --sysctl value                  Sysctl options (default map[])
      --tmpfs value                   Mount a tmpfs directory (default [])
  -t, --tty                           Allocate a pseudo-TTY
      --ulimit value                  Ulimit options (default [])
  -u, --user string                   Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])
      --userns string                 User namespace to use
                                      &#x27;host&#x27;: Use the Docker host user namespace
                                      &#x27;&#x27;: Use the Docker daemon user namespace specified by `--userns-remap` option.
      --uts string                    UTS namespace to use
  -v, --volume value                  Bind mount a volume (default []). The format
                                      is `[host-src:]container-dest[:&lt;options&gt;]`.
                                      The comma-delimited `options` are [rw|ro],
                                      [z|Z], [[r]shared|[r]slave|[r]private],
                                      [delegated|cached|consistent], and
                                      [nocopy]. The &#x27;host-src&#x27; is an absolute path
                                      or a name value.
      --volume-driver string          Optional volume driver for the container
      --volumes-from value            Mount volumes from the specified container(s) (default [])
  -w, --workdir string                Working directory inside the container
</span></code></pre>
<h2 id="description" tabindex="-1">Description <a class="header-anchor" href="#description" aria-hidden="true">ðŸ”—</a></h2>
<p>The <code>docker run</code> command first <code>creates</code> a writeable container layer over the
specified image, and then <code>starts</code> it using the specified command. That is,
<code>docker run</code> is equivalent to the API <code>/containers/create</code> then
<code>/containers/(id)/start</code>. A stopped container can be restarted with all its
previous changes intact using <code>docker start</code>. See <code>docker ps -a</code> to view a list
of all containers.</p>
<p>The <code>docker run</code> command can be used in combination with <code>docker commit</code> to
<a href="commit.html"><em>change the command that a container runs</em></a>. There is additional detailed information about <code>docker run</code> in the <a href="../run.html">Docker run reference</a>.</p>
<p>For information on connecting a container to a network, see the <a href="https://docs.docker.com/network/">&quot;<em>Docker network overview</em>&quot;</a>.</p>
<h2 id="examples" tabindex="-1">Examples <a class="header-anchor" href="#examples" aria-hidden="true">ðŸ”—</a></h2>
<h3 id="assign-name-and-allocate-pseudo-tty-(--name%2C--it)" tabindex="-1">Assign name and allocate pseudo-TTY (--name, -it) <a class="header-anchor" href="#assign-name-and-allocate-pseudo-tty-(--name%2C--it)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --name <span class="hljs-built_in">test</span> -it debian</span>

root@d6c0fe130dba:/# exit 13
<span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> $?</span>
13
<span class="hljs-meta prompt_">$ </span><span class="language-bash">docker ps -a | grep <span class="hljs-built_in">test</span></span>
d6c0fe130dba        debian:7            &quot;/bin/bash&quot;         26 seconds ago      Exited (13) 17 seconds ago                         test
</code></pre>
<p>This example runs a container named <code>test</code> using the <code>debian:latest</code>
image. The <code>-it</code> instructs Docker to allocate a pseudo-TTY connected to
the container's stdin; creating an interactive <code>bash</code> shell in the container.
In the example, the <code>bash</code> shell is quit by entering
<code>exit 13</code>. This exit code is passed on to the caller of
<code>docker run</code>, and is recorded in the <code>test</code> container's metadata.</p>
<h3 id="capture-container-id-(--cidfile)" tabindex="-1">Capture container ID (--cidfile) <a class="header-anchor" href="#capture-container-id-(--cidfile)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --cidfile /tmp/docker_test.cid ubuntu <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;test&quot;</span></span>
</code></pre>
<p>This will create a container and print <code>test</code> to the console. The <code>cidfile</code>
flag makes Docker attempt to create a new file and write the container ID to it.
If the file exists already, Docker will return an error. Docker will close this
file when <code>docker run</code> exits.</p>
<h3 id="full-container-capabilities-(--privileged)" tabindex="-1">Full container capabilities (--privileged) <a class="header-anchor" href="#full-container-capabilities-(--privileged)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -t -i --<span class="hljs-built_in">rm</span> ubuntu bash</span>
root@bc338942ef20:/# mount -t tmpfs none /mnt
mount: permission denied
</code></pre>
<p>This will <em>not</em> work, because by default, most potentially dangerous kernel
capabilities are dropped; including <code>cap_sys_admin</code> (which is required to mount
filesystems). However, the <code>--privileged</code> flag will allow it to run:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -t -i --privileged ubuntu bash</span>
root@50e3f57e16e6:/# mount -t tmpfs none /mnt
root@50e3f57e16e6:/# df -h
Filesystem      Size  Used Avail Use% Mounted on
none            1.9G     0  1.9G   0% /mnt
</code></pre>
<p>The <code>--privileged</code> flag gives <em>all</em> capabilities to the container, and it also
lifts all the limitations enforced by the <code>device</code> cgroup controller. In other
words, the container can then do almost everything that the host can do. This
flag exists to allow special use-cases, like running Docker within Docker.</p>
<h3 id="set-working-directory-(-w)" tabindex="-1">Set working directory (-w) <a class="header-anchor" href="#set-working-directory-(-w)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker  run -w /path/to/dir/ -i -t  ubuntu <span class="hljs-built_in">pwd</span></span>
</code></pre>
<p>The <code>-w</code> lets the command being executed inside directory given, here
<code>/path/to/dir/</code>. If the path does not exist it is created inside the container.</p>
<h3 id="set-storage-driver-options-per-container" tabindex="-1">Set storage driver options per container <a class="header-anchor" href="#set-storage-driver-options-per-container" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -it --storage-opt size=120G fedora /bin/bash</span>
</code></pre>
<p>This (size) will allow to set the container rootfs size to 120G at creation time.
This option is only available for the <code>devicemapper</code>, <code>btrfs</code>, <code>overlay2</code>,
<code>windowsfilter</code> and <code>zfs</code> graph drivers.
For the <code>devicemapper</code>, <code>btrfs</code>, <code>windowsfilter</code> and <code>zfs</code> graph drivers,
user cannot pass a size less than the Default BaseFS Size.
For the <code>overlay2</code> storage driver, the size option is only available if the
backing fs is <code>xfs</code> and mounted with the <code>pquota</code> mount option.
Under these conditions, user can pass any size less than the backing fs size.</p>
<h3 id="mount-tmpfs-(--tmpfs)" tabindex="-1">Mount tmpfs (--tmpfs) <a class="header-anchor" href="#mount-tmpfs-(--tmpfs)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -d --tmpfs /run:rw,noexec,nosuid,size=65536k my_image</span>
</code></pre>
<p>The <code>--tmpfs</code> flag mounts an empty tmpfs into the container with the <code>rw</code>,
<code>noexec</code>, <code>nosuid</code>, <code>size=65536k</code> options.</p>
<h3 id="mount-volume-(-v%2C---read-only)" tabindex="-1">Mount volume (-v, --read-only) <a class="header-anchor" href="#mount-volume-(-v%2C---read-only)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker  run  -v `<span class="hljs-built_in">pwd</span>`:`<span class="hljs-built_in">pwd</span>` -w `<span class="hljs-built_in">pwd</span>` -i -t  ubuntu <span class="hljs-built_in">pwd</span></span>
</code></pre>
<p>The <code>-v</code> flag mounts the current working directory into the container. The <code>-w</code>
lets the command being executed inside the current working directory, by
changing into the directory to the value returned by <code>pwd</code>. So this
combination executes the command using the container, but inside the
current working directory.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -v /doesnt/exist:/foo -w /foo -i -t ubuntu bash</span>
</code></pre>
<p>When the host directory of a bind-mounted volume doesn't exist, Docker
will automatically create this directory on the host for you. In the
example above, Docker will create the <code>/doesnt/exist</code>
folder before starting your container.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --read-only -v /icanwrite busybox <span class="hljs-built_in">touch</span> /icanwrite/here</span>
</code></pre>
<p>Volumes can be used in combination with <code>--read-only</code> to control where
a container writes files. The <code>--read-only</code> flag mounts the container's root
filesystem as read only prohibiting writes to locations other than the
specified volumes for the container.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -t -i -v /var/run/docker.sock:/var/run/docker.sock -v /path/to/static-docker-binary:/usr/bin/docker busybox sh</span>
</code></pre>
<p>By bind-mounting the docker unix socket and statically linked docker
binary (refer to <a href="https://docs.docker.com/engine/install/binaries/#install-static-binaries">get the linux binary</a>),
you give the container the full access to create and manipulate the host's
Docker daemon.</p>
<p>On Windows, the paths must be specified using Windows-style semantics.</p>
<pre><code class="language-powershell"><span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-v</span> c:\foo:c:\dest microsoft/nanoserver cmd /s /c <span class="hljs-built_in">type</span> c:\dest\somefile.txt
Contents of file

<span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-v</span> c:\foo:d: microsoft/nanoserver cmd /s /c <span class="hljs-built_in">type</span> d:\somefile.txt
Contents of file
</code></pre>
<p>The following examples will fail when using Windows-based containers, as the
destination of a volume or bind mount inside the container must be one of:
a non-existing or empty directory; or a drive other than C:. Further, the source
of a bind mount must be a local directory, not a file.</p>
<pre><code class="language-powershell">net use z: \\remotemachine\share
docker run <span class="hljs-literal">-v</span> z:\foo:c:\dest ...
docker run <span class="hljs-literal">-v</span> \\uncpath\to\directory:c:\dest ...
docker run <span class="hljs-literal">-v</span> c:\foo\somefile.txt:c:\dest ...
docker run <span class="hljs-literal">-v</span> c:\foo:c: ...
docker run <span class="hljs-literal">-v</span> c:\foo:c:\existing<span class="hljs-literal">-directory-with-contents</span> ...
</code></pre>
<p>For in-depth information about volumes, refer to <a href="https://docs.docker.com/storage/volumes/">manage data in containers</a></p>
<h3 id="add-bind-mounts-or-volumes-using-the---mount-flag" tabindex="-1">Add bind mounts or volumes using the --mount flag <a class="header-anchor" href="#add-bind-mounts-or-volumes-using-the---mount-flag" aria-hidden="true">ðŸ”—</a></h3>
<p>The <code>--mount</code> flag allows you to mount volumes, host-directories and <code>tmpfs</code>
mounts in a container.</p>
<p>The <code>--mount</code> flag supports most options that are supported by the <code>-v</code> or the
<code>--volume</code> flag, but uses a different syntax. For in-depth information on the
<code>--mount</code> flag, and a comparison between <code>--volume</code> and <code>--mount</code>, refer to
the <a href="service_create.md#add-bind-mounts-volumes-or-memory-filesystems">service create command reference</a>.</p>
<p>Even though there is no plan to deprecate <code>--volume</code>, usage of <code>--mount</code> is recommended.</p>
<p>Examples:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --read-only --mount <span class="hljs-built_in">type</span>=volume,target=/icanwrite busybox <span class="hljs-built_in">touch</span> /icanwrite/here</span>
</code></pre>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -t -i --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,src=/data,dst=/data busybox sh</span>
</code></pre>
<h3 id="publish-or-expose-port-(-p%2C---expose)" tabindex="-1">Publish or expose port (-p, --expose) <a class="header-anchor" href="#publish-or-expose-port-(-p%2C---expose)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -p 127.0.0.1:80:8080/tcp ubuntu bash</span>
</code></pre>
<p>This binds port <code>8080</code> of the container to TCP port <code>80</code> on <code>127.0.0.1</code> of the host
machine. You can also specify <code>udp</code> and <code>sctp</code> ports.
The <a href="https://docs.docker.com/network/links/">Docker User Guide</a>
explains in detail how to manipulate ports in Docker.</p>
<p>Note that ports which are not bound to the host (i.e., <code>-p 80:80</code> instead of
<code>-p 127.0.0.1:80:80</code>) will be accessible from the outside. This also applies if
you configured UFW to block this specific port, as Docker manages its
own iptables rules. <a href="https://docs.docker.com/network/iptables/">Read more</a></p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --expose 80 ubuntu bash</span>
</code></pre>
<p>This exposes port <code>80</code> of the container without publishing the port to the host
system's interfaces.</p>
<h3 id="set-environment-variables-(-e%2C---env%2C---env-file)" tabindex="-1">Set environment variables (-e, --env, --env-file) <a class="header-anchor" href="#set-environment-variables-(-e%2C---env%2C---env-file)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -e MYVAR1 --<span class="hljs-built_in">env</span> MYVAR2=foo --env-file ./env.list ubuntu bash</span>
</code></pre>
<p>Use the <code>-e</code>, <code>--env</code>, and <code>--env-file</code> flags to set simple (non-array)
environment variables in the container you're running, or overwrite variables
that are defined in the Dockerfile of the image you're running.</p>
<p>You can define the variable and its value when running the container:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --<span class="hljs-built_in">env</span> VAR1=value1 --<span class="hljs-built_in">env</span> VAR2=value2 ubuntu <span class="hljs-built_in">env</span> | grep VAR</span>
VAR1=value1
VAR2=value2
</code></pre>
<p>You can also use variables that you've exported to your local environment:</p>
<pre><code class="language-console">export VAR1=value1
export VAR2=value2
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run --<span class="hljs-built_in">env</span> VAR1 --<span class="hljs-built_in">env</span> VAR2 ubuntu <span class="hljs-built_in">env</span> | grep VAR</span>
VAR1=value1
VAR2=value2
</code></pre>
<p>When running the command, the Docker CLI client checks the value the variable
has in your local environment and passes it to the container.
If no <code>=</code> is provided and that variable is not exported in your local
environment, the variable won't be set in the container.</p>
<p>You can also load the environment variables from a file. This file should use
the syntax <code>&lt;variable&gt;=value</code> (which sets the variable to the given value) or
<code>&lt;variable&gt;</code> (which takes the value from the local environment), and <code>#</code> for comments.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> env.list</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">This is a comment</span>
VAR1=value1
VAR2=value2
USER
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run --env-file env.list ubuntu <span class="hljs-built_in">env</span> | grep -E <span class="hljs-string">&#x27;VAR|USER&#x27;</span></span>
VAR1=value1
VAR2=value2
USER=jonzeolla
</code></pre>
<h3 id="set-metadata-on-container-(-l%2C---label%2C---label-file)" tabindex="-1">Set metadata on container (-l, --label, --label-file) <a class="header-anchor" href="#set-metadata-on-container-(-l%2C---label%2C---label-file)" aria-hidden="true">ðŸ”—</a></h3>
<p>A label is a <code>key=value</code> pair that applies metadata to a container. To label a container with two labels:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -l my-label --label com.example.foo=bar ubuntu bash</span>
</code></pre>
<p>The <code>my-label</code> key doesn't specify a value so the label defaults to an empty
string (<code>&quot;&quot;</code>). To add multiple labels, repeat the label flag (<code>-l</code> or <code>--label</code>).</p>
<p>The <code>key=value</code> must be unique to avoid overwriting the label value. If you
specify labels with identical keys but different values, each subsequent value
overwrites the previous. Docker uses the last <code>key=value</code> you supply.</p>
<p>Use the <code>--label-file</code> flag to load multiple labels from a file. Delimit each
label in the file with an EOL mark. The example below loads labels from a
labels file in the current directory:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --label-file ./labels ubuntu bash</span>
</code></pre>
<p>The label-file format is similar to the format for loading environment
variables. (Unlike environment variables, labels are not visible to processes
running inside a container.) The following example illustrates a label-file
format:</p>
<pre><code class="language-console">com.example.label1=&quot;a label&quot;
<span class="hljs-meta prompt_">
# </span><span class="language-bash">this is a comment</span>
com.example.label2=another\ label
com.example.label3
</code></pre>
<p>You can load multiple label-files by supplying multiple  <code>--label-file</code> flags.</p>
<p>For additional information on working with labels, see <a href="https://docs.docker.com/config/labels-custom-metadata/"><em>Labels - custom
metadata in Docker</em></a> in
the Docker User Guide.</p>
<h3 id="connect-a-container-to-a-network-(--network)" tabindex="-1">Connect a container to a network (--network) <a class="header-anchor" href="#connect-a-container-to-a-network-(--network)" aria-hidden="true">ðŸ”—</a></h3>
<p>When you start a container use the <code>--network</code> flag to connect it to a network.
This adds the <code>busybox</code> container to the <code>my-net</code> network.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -itd --network=my-net busybox</span>
</code></pre>
<p>You can also choose the IP addresses for the container with <code>--ip</code> and <code>--ip6</code>
flags when you start the container on a user-defined network.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -itd --network=my-net --ip=10.10.9.75 busybox</span>
</code></pre>
<p>If you want to add a running container to a network use the <code>docker network connect</code> subcommand.</p>
<p>You can connect multiple containers to the same network. Once connected, the
containers can communicate easily using only another container's IP address
or name. For <code>overlay</code> networks or custom plugins that support multi-host
connectivity, containers connected to the same multi-host network but launched
from different Engines can also communicate in this way.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>Service discovery is unavailable on the default bridge network. Containers can
communicate via their IP addresses by default. To communicate by name, they
must be linked.</p>
</blockquote>
<p>You can disconnect a container from a network using the <code>docker network disconnect</code> command.</p>
<h3 id="mount-volumes-from-container-(--volumes-from)" tabindex="-1">Mount volumes from container (--volumes-from) <a class="header-anchor" href="#mount-volumes-from-container-(--volumes-from)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --volumes-from 777f7dc92da7 --volumes-from ba8c0c54f0f2:ro -i -t ubuntu <span class="hljs-built_in">pwd</span></span>
</code></pre>
<p>The <code>--volumes-from</code> flag mounts all the defined volumes from the referenced
containers. Containers can be specified by repetitions of the <code>--volumes-from</code>
argument. The container ID may be optionally suffixed with <code>:ro</code> or <code>:rw</code> to
mount the volumes in read-only or read-write mode, respectively. By default,
the volumes are mounted in the same mode (read write or read only) as
the reference container.</p>
<p>Labeling systems like SELinux require that proper labels are placed on volume
content mounted into a container. Without a label, the security system might
prevent the processes running inside the container from using the content. By
default, Docker does not change the labels set by the OS.</p>
<p>To change the label in the container context, you can add either of two suffixes
<code>:z</code> or <code>:Z</code> to the volume mount. These suffixes tell Docker to relabel file
objects on the shared volumes. The <code>z</code> option tells Docker that two containers
share the volume content. As a result, Docker labels the content with a shared
content label. Shared volume labels allow all containers to read/write content.
The <code>Z</code> option tells Docker to label the content with a private unshared label.
Only the current container can use a private volume.</p>
<h3 id="attach-to-stdin%2Fstdout%2Fstderr-(-a)" tabindex="-1">Attach to STDIN/STDOUT/STDERR (-a) <a class="header-anchor" href="#attach-to-stdin%2Fstdout%2Fstderr-(-a)" aria-hidden="true">ðŸ”—</a></h3>
<p>The <code>-a</code> flag tells <code>docker run</code> to bind to the container's <code>STDIN</code>, <code>STDOUT</code>
or <code>STDERR</code>. This makes it possible to manipulate the output and input as
needed.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;test&quot;</span> | docker run -i -a stdin ubuntu <span class="hljs-built_in">cat</span> -</span>
</code></pre>
<p>This pipes data into a container and prints the container's ID by attaching
only to the container's <code>STDIN</code>.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -a stderr ubuntu <span class="hljs-built_in">echo</span> <span class="hljs-built_in">test</span></span>
</code></pre>
<p>This isn't going to print anything unless there's an error because we've
only attached to the <code>STDERR</code> of the container. The container's logs
still store what's been written to <code>STDERR</code> and <code>STDOUT</code>.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> somefile | docker run -i -a stdin mybuilder dobuild</span>
</code></pre>
<p>This is how piping a file into a container could be done for a build.
The container's ID will be printed after the build is done and the build
logs could be retrieved using <code>docker logs</code>. This is
useful if you need to pipe a file or something else into a container and
retrieve the container's ID once the container has finished running.</p>
<h3 id="add-host-device-to-container-(--device)" tabindex="-1">Add host device to container (--device) <a class="header-anchor" href="#add-host-device-to-container-(--device)" aria-hidden="true">ðŸ”—</a></h3>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --device=/dev/sdc:/dev/xvdc \
             --device=/dev/sdd --device=/dev/zero:/dev/nulo \
             -i -t \
             ubuntu <span class="hljs-built_in">ls</span> -l /dev/{xvdc,sdd,nulo}</span>

brw-rw---- 1 root disk 8, 2 Feb  9 16:05 /dev/xvdc
brw-rw---- 1 root disk 8, 3 Feb  9 16:05 /dev/sdd
crw-rw-rw- 1 root root 1, 5 Feb  9 16:05 /dev/nulo
</code></pre>
<p>It is often necessary to directly expose devices to a container. The <code>--device</code>
option enables that. For example, a specific block storage device or loop
device or audio device can be added to an otherwise unprivileged container
(without the <code>--privileged</code> flag) and have the application directly access it.</p>
<p>By default, the container will be able to <code>read</code>, <code>write</code> and <code>mknod</code> these devices.
This can be overridden using a third <code>:rwm</code> set of options to each <code>--device</code>
flag. If the container is running in privileged mode, then the permissions specified
will be ignored.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --device=/dev/sda:/dev/xvdc --<span class="hljs-built_in">rm</span> -it ubuntu fdisk  /dev/xvdc</span>

Command (m for help): q
<span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --device=/dev/sda:/dev/xvdc:r --<span class="hljs-built_in">rm</span> -it ubuntu fdisk  /dev/xvdc</span>
You will not be able to write the partition table.

Command (m for help): q
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run --device=/dev/sda:/dev/xvdc:rw --<span class="hljs-built_in">rm</span> -it ubuntu fdisk  /dev/xvdc</span>

Command (m for help): q
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run --device=/dev/sda:/dev/xvdc:m --<span class="hljs-built_in">rm</span> -it ubuntu fdisk  /dev/xvdc</span>
fdisk: unable to open /dev/xvdc: Operation not permitted
</code></pre>
<blockquote>
<p><strong>Note</strong></p>
<p>The <code>--device</code> option cannot be safely used with ephemeral devices. Block devices
that may be removed should not be added to untrusted containers with <code>--device</code>.</p>
</blockquote>
<p>For Windows, the format of the string passed to the <code>--device</code> option is in
the form of <code>--device=&lt;IdType&gt;/&lt;Id&gt;</code>. Beginning with Windows Server 2019
and Windows 10 October 2018 Update, Windows only supports an IdType of
<code>class</code> and the Id as a <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/overview-of-device-interface-classes">device interface class
GUID</a>.
Refer to the table defined in the <a href="https://docs.microsoft.com/en-us/virtualization/windowscontainers/deploy-containers/hardware-devices-in-containers">Windows container
docs</a>
for a list of container-supported device interface class GUIDs.</p>
<p>If this option is specified for a process-isolated Windows container, <em>all</em>
devices that implement the requested device interface class GUID are made
available in the container. For example, the command below makes all COM
ports on the host visible in the container.</p>
<pre><code class="language-powershell"><span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">--device</span>=<span class="hljs-class"><span class="hljs-keyword">class</span>/86<span class="hljs-title">E0D1E0</span>-8089-11<span class="hljs-title">D0</span>-9<span class="hljs-title">CE4</span>-08003<span class="hljs-title">E301F73</span> <span class="hljs-title">mcr</span>.<span class="hljs-title">microsoft</span>.<span class="hljs-title">com</span>/<span class="hljs-title">windows</span>/<span class="hljs-title">servercore</span>:<span class="hljs-title">ltsc2019</span>
</span></code></pre>
<blockquote>
<p><strong>Note</strong></p>
<p>The <code>--device</code> option is only supported on process-isolated Windows containers.
This option fails if the container isolation is <code>hyperv</code> or when running Linux
Containers on Windows (LCOW).</p>
</blockquote>
<h3 id="access-an-nvidia-gpu" tabindex="-1">Access an NVIDIA GPU <a class="header-anchor" href="#access-an-nvidia-gpu" aria-hidden="true">ðŸ”—</a></h3>
<p>The <code>--gpusÂ­</code> flag allows you to access NVIDIA GPU resources. First you need to
install <a href="https://nvidia.github.io/nvidia-container-runtime/">nvidia-container-runtime</a>.
Visit <a href="https://docs.docker.com/config/containers/resource_constraints/">Specify a container's resources</a>
for more information.</p>
<p>To use <code>--gpus</code>, specify which GPUs (or all) to use. If no value is provied, all
available GPUs are used. The example below exposes all available GPUs.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -it --<span class="hljs-built_in">rm</span> --gpus all ubuntu nvidia-smi</span>
</code></pre>
<p>Use the <code>device</code> option to specify GPUs. The example below exposes a specific
GPU.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -it --<span class="hljs-built_in">rm</span> --gpus device=GPU-3a23c669-1f69-c64e-cf85-44e9b07e7a2a ubuntu nvidia-smi</span>
</code></pre>
<p>The example below exposes the first and third GPUs.</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -it --<span class="hljs-built_in">rm</span> --gpus <span class="hljs-string">&#x27;&quot;device=0,2&quot;&#x27;</span> nvidia-smi</span>
</code></pre>
<h3 id="restart-policies-(--restart)" tabindex="-1">Restart policies (--restart) <a class="header-anchor" href="#restart-policies-(--restart)" aria-hidden="true">ðŸ”—</a></h3>
<p>Use Docker's <code>--restart</code> to specify a container's <em>restart policy</em>. A restart
policy controls whether the Docker daemon restarts a container after exit.
Docker supports the following restart policies:</p>
<table class="table"><thead>
<tr>
<th style="text-align:left">Policy</th>
<th style="text-align:left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>no</code></td>
<td style="text-align:left">Do not automatically restart the container when it exits. This is the default.</td>
</tr>
<tr>
<td style="text-align:left"><code>on-failure[:max-retries]</code></td>
<td style="text-align:left">Restart only if the container exits with a non-zero exit status. Optionally, limit the number of restart retries the Docker daemon attempts.</td>
</tr>
<tr>
<td style="text-align:left"><code>unless-stopped</code></td>
<td style="text-align:left">Restart the container unless it is explicitly stopped or Docker itself is stopped or restarted.</td>
</tr>
<tr>
<td style="text-align:left"><code>always</code></td>
<td style="text-align:left">Always restart the container regardless of the exit status. When you specify always, the Docker daemon will try to restart the container indefinitely. The container will also always start on daemon startup, regardless of the current state of the container.</td>
</tr>
</tbody>
</table>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --restart=always redis</span>
</code></pre>
<p>This will run the <code>redis</code> container with a restart policy of <strong>always</strong>
so that if the container exits, Docker will restart it.</p>
<p>More detailed information on restart policies can be found in the
<a href="../run.md#restart-policies---restart">Restart Policies (--restart)</a>
section of the Docker run reference page.</p>
<h3 id="add-entries-to-container-hosts-file-(--add-host)" tabindex="-1">Add entries to container hosts file (--add-host) <a class="header-anchor" href="#add-entries-to-container-hosts-file-(--add-host)" aria-hidden="true">ðŸ”—</a></h3>
<p>You can add other hosts into a container's <code>/etc/hosts</code> file by using one or
more <code>--add-host</code> flags. This example adds a static address for a host named
<code>docker</code>:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --add-host=docker:93.184.216.34 --<span class="hljs-built_in">rm</span> -it alpine</span>

/ # ping docker
PING docker (93.184.216.34): 56 data bytes
64 bytes from 93.184.216.34: seq=0 ttl=37 time=93.052 ms
64 bytes from 93.184.216.34: seq=1 ttl=37 time=92.467 ms
64 bytes from 93.184.216.34: seq=2 ttl=37 time=92.252 ms
^C
--- docker ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max = 92.209/92.495/93.052 ms
</code></pre>
<p>Sometimes you need to connect to the Docker host from within your
container. To enable this, pass the Docker host's IP address to
the container using the <code>--add-host</code> flag. To find the host's address,
use the <code>ip addr show</code> command.</p>
<p>The flags you pass to <code>ip addr show</code> depend on whether you are
using IPv4 or IPv6 networking in your containers. Use the following
flags for IPv4 address retrieval for a network device named <code>eth0</code>:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">HOSTIP=`ip -4 addr show scope global dev eth0 | grep inet | awk <span class="hljs-string">&#x27;{print $2}&#x27;</span> | <span class="hljs-built_in">cut</span> -d / -f 1 | sed -n 1p`</span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run  --add-host=docker:<span class="hljs-variable">${HOSTIP}</span> --<span class="hljs-built_in">rm</span> -it debian</span>
</code></pre>
<p>For IPv6 use the <code>-6</code> flag instead of the <code>-4</code> flag. For other network
devices, replace <code>eth0</code> with the correct device name (for example <code>docker0</code>
for the bridge device).</p>
<h3 id="set-ulimits-in-container-(--ulimit)" tabindex="-1">Set ulimits in container (--ulimit) <a class="header-anchor" href="#set-ulimits-in-container-(--ulimit)" aria-hidden="true">ðŸ”—</a></h3>
<p>Since setting <code>ulimit</code> settings in a container requires extra privileges not
available in the default container, you can set these using the <code>--ulimit</code> flag.
<code>--ulimit</code> is specified with a soft and hard limit as such:
<code>&lt;type&gt;=&lt;soft limit&gt;[:&lt;hard limit&gt;]</code>, for example:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --<span class="hljs-built_in">ulimit</span> nofile=1024:1024 --<span class="hljs-built_in">rm</span> debian sh -c <span class="hljs-string">&quot;ulimit -n&quot;</span></span>
1024
</code></pre>
<blockquote>
<p><strong>Note</strong></p>
<p>If you do not provide a <code>hard limit</code>, the <code>soft limit</code> is used
for both values. If no <code>ulimits</code> are set, they are inherited from
the default <code>ulimits</code> set on the daemon. The <code>as</code> option is disabled now.
In other words, the following script is not supported:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -it --<span class="hljs-built_in">ulimit</span> as=1024 fedora /bin/bash</span>
</code></pre>
</blockquote>
<p>The values are sent to the appropriate <code>syscall</code> as they are set.
Docker doesn't perform any byte conversion. Take this into account when setting the values.</p>
<h4 id="for-nproc-usage" tabindex="-1">For <code>nproc</code> usage <a class="header-anchor" href="#for-nproc-usage" aria-hidden="true">ðŸ”—</a></h4>
<p>Be careful setting <code>nproc</code> with the <code>ulimit</code> flag as <code>nproc</code> is designed by Linux to set the
maximum number of processes available to a user, not to a container.  For example, start four
containers with <code>daemon</code> user:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -d -u daemon --<span class="hljs-built_in">ulimit</span> <span class="hljs-built_in">nproc</span>=3 busybox top</span>
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run -d -u daemon --<span class="hljs-built_in">ulimit</span> <span class="hljs-built_in">nproc</span>=3 busybox top</span>
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run -d -u daemon --<span class="hljs-built_in">ulimit</span> <span class="hljs-built_in">nproc</span>=3 busybox top</span>
<span class="hljs-meta prompt_">
$ </span><span class="language-bash">docker run -d -u daemon --<span class="hljs-built_in">ulimit</span> <span class="hljs-built_in">nproc</span>=3 busybox top</span>
</code></pre>
<p>The 4th container fails and reports &quot;[8] System error: resource temporarily unavailable&quot; error.
This fails because the caller set <code>nproc=3</code> resulting in the first three containers using up
the three processes quota set for the <code>daemon</code> user.</p>
<h3 id="stop-container-with-signal-(--stop-signal)" tabindex="-1">Stop container with signal (--stop-signal) <a class="header-anchor" href="#stop-container-with-signal-(--stop-signal)" aria-hidden="true">ðŸ”—</a></h3>
<p>The <code>--stop-signal</code> flag sets the system call signal that will be sent to the
container to exit. This signal can be a signal name in the format <code>SIG&lt;NAME&gt;</code>,
for instance <code>SIGKILL</code>, or an unsigned number that matches a position in the
kernel's syscall table, for instance <code>9</code>.</p>
<p>The default is defined by <a href="https://docs.docker.com/reference/dockerfile/#stopsignal"><code>STOPSIGNAL</code></a>
in the image, or <code>SIGTERM</code> if the image has no <code>STOPSIGNAL</code> defined.</p>
<h3 id="optional-security-options-(--security-opt)" tabindex="-1">Optional security options (--security-opt) <a class="header-anchor" href="#optional-security-options-(--security-opt)" aria-hidden="true">ðŸ”—</a></h3>
<p>On Windows, this flag can be used to specify the <code>credentialspec</code> option.
The <code>credentialspec</code> must be in the format <code>file://spec.txt</code> or <code>registry://keyname</code>.</p>
<h3 id="stop-container-with-timeout-(--stop-timeout)" tabindex="-1">Stop container with timeout (--stop-timeout) <a class="header-anchor" href="#stop-container-with-timeout-(--stop-timeout)" aria-hidden="true">ðŸ”—</a></h3>
<p>The <code>--stop-timeout</code> flag sets the number of seconds to wait for the container
to stop after sending the pre-defined (see <code>--stop-signal</code>) system call signal.
If the container does not exit after the timeout elapses, it is forcibly killed
with a <code>SIGKILL</code> signal.</p>
<p>If <code>--stop-timeout</code> is set to <code>-1</code>, no timeout is applied, and the daemon will
wait indefinitely for the container to exit.</p>
<p>The default is determined by the daemon, and is 10 seconds for Linux containers,
and 30 seconds for Windows containers.</p>
<h3 id="specify-isolation-technology-for-container-(--isolation)" tabindex="-1">Specify isolation technology for container (--isolation) <a class="header-anchor" href="#specify-isolation-technology-for-container-(--isolation)" aria-hidden="true">ðŸ”—</a></h3>
<p>This option is useful in situations where you are running Docker containers on
Windows. The <code>--isolation &lt;value&gt;</code> option sets a container's isolation technology.
On Linux, the only supported is the <code>default</code> option which uses
Linux namespaces. These two commands are equivalent on Linux:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -d busybox top</span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -d --isolation default busybox top</span>
</code></pre>
<p>On Windows, <code>--isolation</code> can take one of these values:</p>
<table class="table"><thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>default</code></td>
<td style="text-align:left">Use the value specified by the Docker daemon's <code>--exec-opt</code> or system default (see below).</td>
</tr>
<tr>
<td style="text-align:left"><code>process</code></td>
<td style="text-align:left">Shared-kernel namespace isolation (not supported on Windows client operating systems older than Windows 10 1809).</td>
</tr>
<tr>
<td style="text-align:left"><code>hyperv</code></td>
<td style="text-align:left">Hyper-V hypervisor partition-based isolation.</td>
</tr>
</tbody>
</table>
<p>The default isolation on Windows server operating systems is <code>process</code>. The default
isolation on Windows client operating systems is <code>hyperv</code>. An attempt to start a container on a client
operating system older than Windows 10 1809 with <code>--isolation process</code> will fail.</p>
<p>On Windows server, assuming the default configuration, these commands are equivalent
and result in <code>process</code> isolation:</p>
<pre><code class="language-powershell"><span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-d</span> microsoft/nanoserver powershell <span class="hljs-built_in">echo</span> <span class="hljs-keyword">process</span>
<span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-d</span> <span class="hljs-literal">--isolation</span> default microsoft/nanoserver powershell <span class="hljs-built_in">echo</span> <span class="hljs-keyword">process</span>
<span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-d</span> <span class="hljs-literal">--isolation</span> <span class="hljs-keyword">process</span> microsoft/nanoserver powershell <span class="hljs-built_in">echo</span> <span class="hljs-keyword">process</span>
</code></pre>
<p>If you have set the <code>--exec-opt isolation=hyperv</code> option on the Docker <code>daemon</code>, or
are running against a Windows client-based daemon, these commands are equivalent and
result in <code>hyperv</code> isolation:</p>
<pre><code class="language-powershell"><span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-d</span> microsoft/nanoserver powershell <span class="hljs-built_in">echo</span> hyperv
<span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-d</span> <span class="hljs-literal">--isolation</span> default microsoft/nanoserver powershell <span class="hljs-built_in">echo</span> hyperv
<span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-d</span> <span class="hljs-literal">--isolation</span> hyperv microsoft/nanoserver powershell <span class="hljs-built_in">echo</span> hyperv
</code></pre>
<h3 id="specify-hard-limits-on-memory-available-to-containers-(-m%2C---memory)" tabindex="-1">Specify hard limits on memory available to containers (-m, --memory) <a class="header-anchor" href="#specify-hard-limits-on-memory-available-to-containers-(-m%2C---memory)" aria-hidden="true">ðŸ”—</a></h3>
<p>These parameters always set an upper limit on the memory available to the container. On Linux, this
is set on the cgroup and applications in a container can query it at <code>/sys/fs/cgroup/memory/memory.limit_in_bytes</code>.</p>
<p>On Windows, this will affect containers differently depending on what type of isolation is used.</p>
<ul>
<li>
<p>With <code>process</code> isolation, Windows will report the full memory of the host system, not the limit to applications running inside the container</p>
<pre><code class="language-powershell"><span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-it</span> <span class="hljs-literal">-m</span> <span class="hljs-number">2</span>GB <span class="hljs-literal">--isolation</span>=<span class="hljs-keyword">process</span> microsoft/nanoserver powershell <span class="hljs-built_in">Get-ComputerInfo</span> *memory*

CsTotalPhysicalMemory      : <span class="hljs-number">17064509440</span>
CsPhyicallyInstalledMemory : <span class="hljs-number">16777216</span>
OsTotalVisibleMemorySize   : <span class="hljs-number">16664560</span>
OsFreePhysicalMemory       : <span class="hljs-number">14646720</span>
OsTotalVirtualMemorySize   : <span class="hljs-number">19154928</span>
OsFreeVirtualMemory        : <span class="hljs-number">17197440</span>
OsInUseVirtualMemory       : <span class="hljs-number">1957488</span>
OsMaxProcessMemorySize     : <span class="hljs-number">137438953344</span>
</code></pre>
</li>
<li>
<p>With <code>hyperv</code> isolation, Windows will create a utility VM that is big enough to hold the memory limit, plus the minimal OS needed to host the container. That size is reported as &quot;Total Physical Memory.&quot;</p>
<pre><code class="language-powershell"><span class="hljs-built_in">PS</span> C:\&gt; docker run <span class="hljs-literal">-it</span> <span class="hljs-literal">-m</span> <span class="hljs-number">2</span>GB <span class="hljs-literal">--isolation</span>=hyperv microsoft/nanoserver powershell <span class="hljs-built_in">Get-ComputerInfo</span> *memory*

CsTotalPhysicalMemory      : <span class="hljs-number">2683355136</span>
CsPhyicallyInstalledMemory :
OsTotalVisibleMemorySize   : <span class="hljs-number">2620464</span>
OsFreePhysicalMemory       : <span class="hljs-number">2306552</span>
OsTotalVirtualMemorySize   : <span class="hljs-number">2620464</span>
OsFreeVirtualMemory        : <span class="hljs-number">2356692</span>
OsInUseVirtualMemory       : <span class="hljs-number">263772</span>
OsMaxProcessMemorySize     : <span class="hljs-number">137438953344</span>
</code></pre>
</li>
</ul>
<h3 id="configure-namespaced-kernel-parameters-(sysctls)-at-runtime" tabindex="-1">Configure namespaced kernel parameters (sysctls) at runtime <a class="header-anchor" href="#configure-namespaced-kernel-parameters-(sysctls)-at-runtime" aria-hidden="true">ðŸ”—</a></h3>
<p>The <code>--sysctl</code> sets namespaced kernel parameters (sysctls) in the
container. For example, to turn on IP forwarding in the containers
network namespace, run this command:</p>
<pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --sysctl net.ipv4.ip_forward=1 someimage</span>
</code></pre>
<blockquote>
<p><strong>Note</strong></p>
<p>Not all sysctls are namespaced. Docker does not support changing sysctls
inside of a container that also modify the host system. As the kernel
evolves we expect to see more sysctls become namespaced.</p>
</blockquote>
<h4 id="currently-supported-sysctls" tabindex="-1">Currently supported sysctls <a class="header-anchor" href="#currently-supported-sysctls" aria-hidden="true">ðŸ”—</a></h4>
<p>IPC Namespace:</p>
<ul>
<li><code>kernel.msgmax</code>, <code>kernel.msgmnb</code>, <code>kernel.msgmni</code>, <code>kernel.sem</code>,
<code>kernel.shmall</code>, <code>kernel.shmmax</code>, <code>kernel.shmmni</code>, <code>kernel.shm_rmid_forced</code>.</li>
<li>Sysctls beginning with <code>fs.mqueue.*</code></li>
<li>If you use the <code>--ipc=host</code> option these sysctls are not allowed.</li>
</ul>
<p>Network Namespace:</p>
<ul>
<li>Sysctls beginning with <code>net.*</code></li>
<li>If you use the <code>--network=host</code> option using these sysctls are not allowed.</li>
</ul>
</body></html>