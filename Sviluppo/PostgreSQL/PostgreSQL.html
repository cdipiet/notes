<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
    <head>
        <meta charset="utf-8" />
        <meta name="generator" content="markdown-it" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
        <meta name="author" content="runner" />
        <meta name="dcterms.date" content="2025-04-08 13:38:18.716" />
        <title>PostgreSQL</title>
        <style type="text/css">
            code {
                white-space: pre-wrap;
            }
            span.smallcaps {
                font-variant: small-caps;
            }
            span.underline {
                text-decoration: underline;
            }
            div.column {
                display: inline-block;
                vertical-align: top;
                width: 50%;
            }
        </style>
        <style type="text/css">
            a.sourceLine {
                display: inline-block;
                line-height: 1.25;
            }
            a.sourceLine {
                pointer-events: none;
                color: inherit;
                text-decoration: inherit;
            }
            a.sourceLine:empty {
                height: 1.2em;
            }
            .sourceCode {
                overflow: visible;
            }
            code.sourceCode {
                white-space: pre;
                position: relative;
            }
            div.sourceCode {
                margin: 1em 0;
            }
            pre.sourceCode {
                margin: 0;
            }
            @media screen {
                div.sourceCode {
                    overflow: auto;
                }
            }
            @media print {
                code.sourceCode {
                    white-space: pre-wrap;
                }
                a.sourceLine {
                    text-indent: -1em;
                    padding-left: 1em;
                }
            }
            pre.numberSource a.sourceLine {
                position: relative;
                left: -4em;
            }
            pre.numberSource a.sourceLine::before {
                content: attr(title);
                position: relative;
                left: -1em;
                text-align: right;
                vertical-align: baseline;
                border: none;
                pointer-events: all;
                display: inline-block;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                padding: 0 4px;
                width: 4em;
                background-color: #ffffff;
                color: #a0a0a0;
            }
            pre.numberSource {
                margin-left: 3em;
                border-left: 1px solid #a0a0a0;
                padding-left: 4px;
            }
            div.sourceCode {
                color: #1f1c1b;
                background-color: #ffffff;
            }
            @media screen {
                a.sourceLine::before {
                    text-decoration: underline;
                }
            }
            code span {
                color: #1f1c1b;
            } /* Normal */
            code span.al {
                color: #bf0303;
                background-color: #f7e6e6;
                font-weight: bold;
            } /* Alert */
            code span.an {
                color: #ca60ca;
            } /* Annotation */
            code span.at {
                color: #0057ae;
            } /* Attribute */
            code span.bn {
                color: #b08000;
            } /* BaseN */
            code span.bu {
                color: #644a9b;
                font-weight: bold;
            } /* BuiltIn */
            code span.cf {
                color: #1f1c1b;
                font-weight: bold;
            } /* ControlFlow */
            code span.ch {
                color: #924c9d;
            } /* Char */
            code span.cn {
                color: #aa5500;
            } /* Constant */
            code span.co {
                color: #898887;
            } /* Comment */
            code span.cv {
                color: #0095ff;
            } /* CommentVar */
            code span.do {
                color: #607880;
            } /* Documentation */
            code span.dt {
                color: #0057ae;
            } /* DataType */
            code span.dv {
                color: #b08000;
            } /* DecVal */
            code span.er {
                color: #bf0303;
                text-decoration: underline;
            } /* Error */
            code span.ex {
                color: #0095ff;
                font-weight: bold;
            } /* Extension */
            code span.fl {
                color: #b08000;
            } /* Float */
            code span.fu {
                color: #644a9b;
            } /* Function */
            code span.im {
                color: #ff5500;
            } /* Import */
            code span.in {
                color: #b08000;
            } /* Information */
            code span.kw {
                color: #1f1c1b;
                font-weight: bold;
            } /* Keyword */
            code span.op {
                color: #1f1c1b;
            } /* Operator */
            code span.ot {
                color: #006e28;
            } /* Other */
            code span.pp {
                color: #006e28;
            } /* Preprocessor */
            code span.re {
                color: #0057ae;
                background-color: #e0e9f8;
            } /* RegionMarker */
            code span.sc {
                color: #3daee9;
            } /* SpecialChar */
            code span.ss {
                color: #ff5500;
            } /* SpecialString */
            code span.st {
                color: #bf0303;
            } /* String */
            code span.va {
                color: #0057ae;
            } /* Variable */
            code span.vs {
                color: #bf0303;
            } /* VerbatimString */
            code span.wa {
                color: #bf0303;
            } /* Warning */
        </style>
        <!--
  Firefox non carica font da locale quindi il font può non essere visibile
  quando di carica la pagina da locale.
  Bisogna impostare about:config
    security.fileuri.strict_origin_policy = false
  -->
        <link rel="stylesheet" href="../../inc/css/katex.min.css" />
        <link rel="stylesheet" href="../../inc/css/fonts/google_fonts.css" />
        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"> -->
        <link rel="stylesheet" href="../../inc/css/bootstrap.min.css" />
        <link rel="stylesheet" href="../../inc/css/cdp.css" />
        <!--[if lt IE 9]>
            <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <![endif]-->
        <meta name="keywords" content="Appunti,Note" />
        <meta name="description" content="Appunti di runner" />
        <link rel="icon" type="image/x-icon" href="../../inc/img/favicon.ico" />
        <link rel="shortcut icon" type="image/x-icon" href="../../inc/img/favicon.ico" />

        <link rel="stylesheet" href="../../inc/js/hljs/styles/default.css" />
        <script src="../../inc/js/hljs/lib/highlight.js"></script>
        <script src="../../inc/js/bootstrap/bootstrap.bundle.min.js"></script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script> -->
        <script>
            hljs.initHighlightingOnLoad();
        </script>
        <script type="module">
            import mermaid from '../../inc/js/mermaid/dist/mermaid.esm.min.mjs';
            // import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
            mermaid.initialize({ startOnLoad: true });
        </script>
    </head>
    <body></body>
</html>
<h1 id="postgresql" tabindex="-1">PostgreSQL <a class="header-anchor" href="#postgresql" aria-hidden="true">🔗</a></h1>
<p class="code">2025-04-08 13:38:18.716</p>
<nav class="table-of-contents"><ol><li><a href="#dbms-postgresql-init">DBMS Postgresql Init </a></li><li><a href="#tablespace">Tablespace </a></li><li><a href="#db-configuration-info">DB Configuration Info </a></li><li><a href="#list-users">List Users </a></li><li><a href="#list-db">List DB </a></li><li><a href="#list-tables">List Tables </a></li><li><a href="#schemaspy">SchemaSpy </a></li><li><a href="#export-dello-schema-del-db">Export dello Schema del DB </a></li><li><a href="#test-connessione-a-postgresql">Test connessione a PostgreSQL </a></li><li><a href="#primi-passi-in-manjaro">Primi Passi in Manjaro </a></li></ol></nav><h1 id="postgresql-1" tabindex="-1">PostgreSQL <a class="header-anchor" href="#postgresql-1" aria-hidden="true">🔗</a></h1>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/PostgreSQL">https://wiki.archlinux.org/title/PostgreSQL</a></p>
</li>
<li>
<p><a href="https://scrivocodice.it/installare-postgresql-manjaro/">https://scrivocodice.it/installare-postgresql-manjaro/</a></p>
</li>
<li>
<p><a href="https://www.geeksforgeeks.org/how-to-install-postgresql-on-arch-based-linux-distributions-manjaro/">https://www.geeksforgeeks.org/how-to-install-postgresql-on-arch-based-linux-distributions-manjaro/</a></p>
</li>
<li>
<p><a href="https://idroot.us/install-postgresql-manjaro-20/">https://idroot.us/install-postgresql-manjaro-20/</a></p>
</li>
<li>
<p><a href="https://gist.github.com/marcorichetta/af0201a74f8185626c0223836cd79cfa">https://gist.github.com/marcorichetta/af0201a74f8185626c0223836cd79cfa</a></p>
</li>
<li>
<p><a href="https://zaiste.net/posts/postgresql-primer-for-busy-people/">https://zaiste.net/posts/postgresql-primer-for-busy-people/</a></p>
</li>
<li>
<p><a href="https://www.postgresqltutorial.com/">https://www.postgresqltutorial.com/</a></p>
</li>
<li>
<p><a href="https://www.tutorialspoint.com/postgresql/index.htm">https://www.tutorialspoint.com/postgresql/index.htm</a></p>
</li>
<li>
<p><a href="https://www.project-open.com/en/howto-postgresql-port-secure-remote-access">https://www.project-open.com/en/howto-postgresql-port-secure-remote-access</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/about/featurematrix/">https://www.postgresql.org/about/featurematrix/</a></p>
</li>
<li>
<p><a href="https://github.com/dhamaniasad/awesome-postgres">https://github.com/dhamaniasad/awesome-postgres</a></p>
</li>
<li>
<p><a href="https://wiki.postgresql.org/wiki/Community_Guide_to_PostgreSQL_GUI_Tools">https://wiki.postgresql.org/wiki/Community_Guide_to_PostgreSQL_GUI_Tools</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/docs/">https://www.postgresql.org/docs/</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/docs/current/app-psql.html">https://www.postgresql.org/docs/current/app-psql.html</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/docs/current/libpq-envars.html">https://www.postgresql.org/docs/current/libpq-envars.html</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/2893954/how-to-pass-in-password-to-pg-dump">https://stackoverflow.com/questions/2893954/how-to-pass-in-password-to-pg-dump</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/docs/current/app-pgdump.html">https://www.postgresql.org/docs/current/app-pgdump.html</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/14486241/postgresql-export-the-schema-of-a-database">https://stackoverflow.com/questions/14486241/postgresql-export-the-schema-of-a-database</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/docs/current/sql-copy.html">https://www.postgresql.org/docs/current/sql-copy.html</a></p>
</li>
<li>
<p><a href="https://www.psycopg.org/psycopg3/docs/basic/copy.html#copy">https://www.psycopg.org/psycopg3/docs/basic/copy.html#copy</a></p>
</li>
</ul>
<h2 id="dbms-postgresql-init" tabindex="-1">DBMS Postgresql Init <a class="header-anchor" href="#dbms-postgresql-init" aria-hidden="true">🔗</a></h2>
<p>The unix user name <code>postgres</code> is often used.<br>
A database <code>clusterv is a collection of databases that is managed by a single instance of a running database server.\ After initialization, a database cluster will contain a database named</code>postgres<code>, which is meant as a</code>default database`.</p>
<p>A database cluster is a <strong>single directory</strong> under which all data will be stored. We call this the data directory or data area.
The data directory must be initialized before being used, using the program <code>initdb</code>.</p>
<p>To initialize a database cluster manually:</p>
<pre><code class="language-sh">    root# <span class="hljs-built_in">mkdir</span> /usr/local/pgsql
    root# <span class="hljs-built_in">chown</span> postgres /usr/local/pgsql
    root# su postgres
    postgres$ initdb -D /usr/local/pgsql/data
</code></pre>
<p>Note that you must execute this command while logged into the PostgreSQL user account.</p>
<p><a href="https://www.postgresql.org/docs/current/server-start.html">https://www.postgresql.org/docs/current/server-start.html</a></p>
<pre><code class="language-sh">$ postgres -D /usr/local/pgsql/data &gt;logfile 2&gt;&amp;1 &amp;
$ su postgres -c <span class="hljs-string">&#x27;pg_ctl start -D /usr/local/pgsql/data -l serverlog&#x27;</span>
/usr/local/pgsql/bin/pg_ctl start -l logfile -D /usr/local/pgsql/data
</code></pre>
<p><a href="https://www.postgresql.org/docs/current/server-shutdown.html#SERVER-SHUTDOWN">https://www.postgresql.org/docs/current/server-shutdown.html#SERVER-SHUTDOWN</a></p>
<pre><code class="language-sh">$ <span class="hljs-built_in">kill</span> -INT `<span class="hljs-built_in">head</span> -1 /usr/local/pgsql/data/postmaster.pid`

/usr/share/lib/pgsql/data/
     postmaster.pid
     postgresql.conf
</code></pre>
<h2 id="tablespace" tabindex="-1">Tablespace <a class="header-anchor" href="#tablespace" aria-hidden="true">🔗</a></h2>
<p><a href="https://stackoverflow.com/questions/63527661/can-we-create-postgresql-table-space-to-point-to-different-drive-outside-of-data">https://stackoverflow.com/questions/63527661/can-we-create-postgresql-table-space-to-point-to-different-drive-outside-of-data</a>
You should create tablespaces only outside the data directory.</p>
<pre><code class="language-sh">[root@postgresqlhost bin]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -t -q -c <span class="hljs-string">&quot;select pg_tablespace_location(oid) from pg_tablespace where spcname=&#x27;mydb&#x27;;&quot;</span>
==&gt; /mnt/database

[root@postgresqlhost bin]# <span class="hljs-built_in">df</span> -h /mnt/database
==&gt;
    Filesystem                   Size  Used Avail Use% Mounted on
    /dev/database                 50G  2.0G   49G   4% /mnt

[root@postgresqlhost bin]# <span class="hljs-built_in">df</span> -h --output=target /mnt/database
Mounted on
/mnt

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres

-bash-4.2$ psql -c <span class="hljs-string">&quot;\db&quot;</span>
                 List of tablespaces
    Name    |  Owner   |          Location
------------+----------+-----------------------------
 apps       | apps     | mydbo/app-database
 mydb       | mydbo    | /mnt/database
 pg_default | postgres |
 pg_global  | postgres |
(4 rows)

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;select pg_tablespace_location(oid) from pg_tablespace;&quot;</span>
[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;select d.rolname, spcname, pg_tablespace_location(t.oid) from pg_tablespace t join pg_authid d on(t.spcowner=d.oid);&quot;</span>
 rolname  |  spcname   |   pg_tablespace_location
----------+------------+-----------------------------
 postgres | pg_global  |
 postgres | pg_default |
 mydbo    | mydb       | /mnt/database
 apps     | apps       | mydbo/app-manager-database
(4 rows)
</code></pre>
<h2 id="db-configuration-info" tabindex="-1">DB Configuration Info <a class="header-anchor" href="#db-configuration-info" aria-hidden="true">🔗</a></h2>
<pre><code class="language-sh"><span class="hljs-comment"># Database Configuration</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql --pset=<span class="hljs-string">&quot;footer=off&quot;</span> -c <span class="hljs-string">&quot;SELECT version();&quot;</span>

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;SHOW ALL&quot;</span>

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SHOW config_file&quot;</span>
/usr/share/lib/pgsql/data/postgresql.conf

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SHOW hba_file&quot;</span>
/usr/share/lib/pgsql/data/pg_hba.conf

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SHOW data_directory&quot;</span>
/usr/share/lib/pgsql/data

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SHOW listen_addresses&quot;</span>
localhost

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SHOW port&quot;</span>
5432

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;SELECT * FROM pg_settings&quot;</span>

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;\d pg_settings&quot;</span>
 name            | text    |           |          |
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;SELECT name,setting,vartype FROM pg_settings WHERE name=&#x27;config_file&#x27;;&quot;</span>
    name     |                setting                 | vartype
-------------+----------------------------------------+---------
 config_file | /usr/share/lib/pgsql/data/postgresql.conf | string


[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SELECT CURRENT_USER;&quot;</span>
postgres

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SELECT CURRENT_ROLE;&quot;</span>
postgres

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;SELECT CURRENT_DATABASE();&quot;</span>
postgres

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -tc <span class="hljs-string">&quot;\c&quot;</span>
You are now connected to database <span class="hljs-string">&quot;postgres&quot;</span> as user <span class="hljs-string">&quot;postgres&quot;</span>.
</code></pre>
<p><a href="https://www.postgresql.org/docs/current/auth-pg-hba-conf.html">https://www.postgresql.org/docs/current/auth-pg-hba-conf.html</a></p>
<p><strong>Host Based Authentication</strong></p>
<p>Specifies the TCP/IP address(es) on which the server is to listen for connections from client applications.
a comma-separated list of host names and/or numeric IP addresses.
The special entry <code>*</code> corresponds to all available IP interfaces.
The entry <code>0.0.0.0</code> allows listening for all IPv4 addresses
and <code>::</code> allows listening for all IPv6 addresses.</p>
<pre><code class="language-sh">[root@postgresqlhost data]# <span class="hljs-built_in">pwd</span>
/usr/share/lib/pgsql/data
[root@postgresqlhost data]# <span class="hljs-built_in">cat</span> pg_hba.conf
<span class="hljs-comment"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span>
<span class="hljs-built_in">local</span>   all             postgres                                peer
host    all             mydbo,apps      127.0.0.1/32            md5
host    all             mydbo,apps      ::18                    md5
</code></pre>
<p><a href="https://www.postgresql.org/docs/current/auth-peer.html">https://www.postgresql.org/docs/current/auth-peer.html</a>
The peer authentication method works by obtaining the client's operating system user name from the kernel
and using it as the allowed database user name (with optional user name mapping).
This method is only supported on local connections.</p>
<p><a href="https://www.postgresql.org/docs/current/auth-password.html">https://www.postgresql.org/docs/current/auth-password.html</a></p>
<p><a href="https://www.postgresql.org/docs/current/auth-pam.html">https://www.postgresql.org/docs/current/auth-pam.html</a></p>
<pre><code class="language-sh">$ <span class="hljs-built_in">cd</span> /usr/share/lib/pgsql/data
[root@postgresqlhost data]# <span class="hljs-built_in">cat</span> pg_hba.conf

<span class="hljs-comment"># Allow any user on the local system to connect to any database with</span>
<span class="hljs-comment"># any database user name using Unix-domain sockets (the default for local</span>
<span class="hljs-comment"># connections).</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span>
<span class="hljs-built_in">local</span>   all             all                                     trust

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;\du+&quot;</span>
                                          List of roles
 Role name |                         Attributes                         | Member of | Description
-----------+------------------------------------------------------------+-----------+-------------
 apps      |                                                            | {}        |
 mydbo     |                                                            | {}        |
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}        |

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;\l+&quot;</span>
                                                                    List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   |  Size   | Tablespace |                Description
-----------+----------+----------+-------------+-------------+-----------------------+---------+------------+--------------------------------------------
 apps      | apps     | UTF8     | en_US.UTF-8 | en_US.UTF-8 |                       | 9269 kB | apps       |
 mydb      | mydbo    | UTF8     | en_US.UTF-8 | en_US.UTF-8 |                       | 1226 MB | mydb       |
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |                       | 8245 kB | pg_default | default administrative connection database
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +| 8289 kB | pg_default | unmodifiable empty database
           |          |          |             |             | postgres=CTc/postgres |         |            |
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | postgres=CTc/postgres+| 8201 kB | pg_default | default template <span class="hljs-keyword">for</span> new databases
           |          |          |             |             | =c/postgres           |         |            |
(5 rows)

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;SELECT * FROM pg_catalog.pg_user&quot;</span>
 usename  | usesysid | usecreatedb | usesuper | userepl | usebypassrls |  passwd  | valuntil | useconfig
----------+----------+-------------+----------+---------+--------------+----------+----------+-----------
 postgres |       10 | t           | t        | t       | t            | ******** |          |
 mydbo    |    16384 | f           | f        | f       | f            | ******** |          |
 apps     |    25778 | f           | f        | f       | f            | ******** |          |
(3 rows)

<span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;SELECT schema_name, schema_owner FROM information_schema.schemata;&quot;</span>
</code></pre>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> 
  c.relname, 
  t.spcname 
<span class="hljs-keyword">FROM</span> 
  pg_class c 
    <span class="hljs-keyword">JOIN</span> pg_tablespace t <span class="hljs-keyword">ON</span> c.reltablespace <span class="hljs-operator">=</span> t.oid 
<span class="hljs-keyword">WHERE</span> 
  t.spcname <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;mydb&#x27;</span>;
</code></pre>
<pre><code class="language-sh">[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql
psql ()
Type <span class="hljs-string">&quot;help&quot;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>.
postgres=# \c mydb
You are now connected to database <span class="hljs-string">&quot;mydb&quot;</span> as user <span class="hljs-string">&quot;postgres&quot;</span>.
mydb=# \dt+
Did not find any relations.
mydb=# SELECT current_user, session_user;
 current_user | session_user
--------------+--------------
 postgres     | postgres
(1 row)
mydb=# <span class="hljs-built_in">set</span> role mydbo;
SET
mydb=&gt; \dt+
Did not find any relations.
mydb=&gt; \db
                 List of tablespaces
    Name    |  Owner   |          Location
------------+----------+-----------------------------
 apps       | apps     | mydbo/app-manager-database
 mydb        | mydbo   | /mnt/database
 pg_default | postgres |
 pg_global  | postgres |
(4 rows)
mydb=&gt; SELECT * FROM pg_tablespace;
  oid  |  spcname   | spcowner | spcacl | spcoptions
-------+------------+----------+--------+------------
  1663 | pg_default |       10 |        |
  1664 | pg_global  |       10 |        |
 16437 | mydb        |    16384 |        |
 16438 | apps       |    25778 |        |
(4 rows)

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb
psql ()
Type <span class="hljs-string">&quot;help&quot;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>.

mydb=# \dt+
Did not find any relations.
mydb=# \dl+
        Large objects
  ID   | Owner  | Description
-------+--------+-------------
 34580 | mydbo |
 34581 | mydbo |
 34582 | mydbo |

<span class="hljs-keyword">select</span> * from pg_largeobject_metadata;

mydb=# <span class="hljs-keyword">select</span> * from pg_largeobject <span class="hljs-built_in">where</span> loid=33333;

mydb=# \dn+
                          List of schemas
  Name  |  Owner   |  Access privileges   |      Description
--------+----------+----------------------+------------------------
 my_scheme | mydbo   |                      |
 public | postgres | postgres=UC/postgres+| standard public schema
        |          | =UC/postgres         |
(2 rows)

SELECT schema_name
FROM information_schema.schemata;

[root@postgresqlhost data]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb
mydb=# \d+ my_scheme.*

mydb=# \dt my_scheme.*
mydb=# \dt+ my_scheme.*
</code></pre>
<h2 id="list-users" tabindex="-1">List Users <a class="header-anchor" href="#list-users" aria-hidden="true">🔗</a></h2>
<p>PostgreSQL represents user accounts as roles.
When you create a role, it is valid in all databases within the database server (or cluster).
Roles that can log in are called login roles or users.
Roles that contain other roles are called group roles.</p>
<p><strong>the concepts of “users” and “groups” have been unified into “roles”</strong>,</p>
<pre><code class="language-sh">[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql --pset=<span class="hljs-string">&quot;footer=off&quot;</span> -c <span class="hljs-string">&quot;\du&quot;</span>
                                   List of roles
 Role name |                         Attributes                         | Member of
-----------+------------------------------------------------------------+-----------
 apps      |                                                            | {}
 mydbo     |                                                            | {}
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}
</code></pre>
<pre><code class="language-sh"><span class="hljs-comment"># List Users</span>
<span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;
SELECT usename AS role_name,
  CASE 
     WHEN usesuper AND usecreatedb THEN 
    CAST(&#x27;superuser, create database&#x27; AS pg_catalog.text)
     WHEN usesuper THEN 
     CAST(&#x27;superuser&#x27; AS pg_catalog.text)
     WHEN usecreatedb THEN 
     CAST(&#x27;create database&#x27; AS pg_catalog.text)
     ELSE 
     CAST(&#x27;&#x27; AS pg_catalog.text)
  END role_attributes
 FROM pg_catalog.pg_user
 ORDER BY role_name desc;
&quot;</span>

 role_name |      role_attributes
-----------+----------------------------
 postgres  | superuser, create database
 mydbo    |
 apps      |

<span class="hljs-built_in">sudo</span> -Hiu postgres psql -c <span class="hljs-string">&quot;SELECT rolname FROM pg_roles;&quot;</span>
          rolname
---------------------------
 pg_monitor
 pg_read_all_settings
 pg_read_all_stats
 pg_stat_scan_tables
 pg_read_server_files
 pg_write_server_files
 pg_execute_server_program
 pg_signal_backend
 postgres
 mydbo
 apps
</code></pre>
<h2 id="list-db" tabindex="-1">List DB <a class="header-anchor" href="#list-db" aria-hidden="true">🔗</a></h2>
<pre><code class="language-sh">[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql -l
                                  List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges
-----------+----------+----------+-------------+-------------+-----------------------
 apps      | apps     | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 mydb       | mydbo   | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | postgres=CTc/postgres+
           |          |          |             |             | =c/postgres

<span class="hljs-comment"># Lista dei DB</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -c <span class="hljs-string">&quot;\l+&quot;</span>
                                                                    List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   |  Size   | Tablespace |                Description
-----------+----------+----------+-------------+-------------+-----------------------+---------+------------+--------------------------------------------
 apps      | apps     | UTF8     | en_US.UTF-8 | en_US.UTF-8 |                       | 9769 kB | apps       |
 mydb       | mydbo   | UTF8     | en_US.UTF-8 | en_US.UTF-8 |                       | 1529 MB | mydb       |
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |                       | 8345 kB | pg_default | default administrative connection database
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +| 8089 kB | pg_default | unmodifiable empty database
           |          |          |             |             | postgres=CTc/postgres |         |            |
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | postgres=CTc/postgres+| 8201 kB | pg_default | default template <span class="hljs-keyword">for</span> new databases

<span class="hljs-comment"># Lista dei DB</span>
<span class="hljs-comment"># https://www.postgresqltutorial.com/postgresql-administration/postgresql-show-databases/</span>
<span class="hljs-comment"># https://www.postgresql.org/docs/current/catalog-pg-authid.html</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -c <span class="hljs-string">&quot;SELECT d.datname, u.rolname FROM pg_catalog.pg_database d join pg_authid u on(d.datdba=u.oid);&quot;</span>
  datname  | rolname
-----------+----------
 template0 | postgres
 template1 | postgres
 apps      | apps
 mydb      | mydbo
 postgres  | postgres

<span class="hljs-comment"># Lista schemas</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -c <span class="hljs-string">&quot;\dn+&quot;</span>
                          List of schemas
  Name     |  Owner   |  Access privileges   |      Description
-----------+----------+----------------------+------------------------
 my_scheme | mydbo    |                      |
 public    | postgres | postgres=UC/postgres+| standard public schema
           |          | =UC/postgres         |

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -c <span class="hljs-string">&quot;SELECT schema_name, schema_owner FROM information_schema.schemata;&quot;</span>
    schema_name     | schema_owner
--------------------+--------------
 pg_toast           | postgres
 pg_temp_1          | postgres
 pg_toast_temp_1    | postgres
 pg_catalog         | postgres
 public             | postgres
 information_schema | postgres
 my_scheme          | mydbo

<span class="hljs-comment"># Lista dei Tablespace</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -c <span class="hljs-string">&quot;\db+&quot;</span>
                                            List of tablespaces
    Name    |  Owner   |          Location           | Access privileges | Options |  Size   | Description
------------+----------+-----------------------------+-------------------+---------+---------+-------------
 apps       | apps     | mydbo/app-manager-database  |                   |         | 9781 kB |
 mydb       | mydbo    | /mnt/database               |                   |         | 1529 MB |
 pg_default | postgres |                             |                   |         | 24 MB   |
 pg_global  | postgres |                             |                   |         | 991 kB  |

<span class="hljs-comment"># Privilegi di accesso</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -c <span class="hljs-string">&quot;\dp my_scheme.*&quot;</span>
                                                       Access privileges
 Schema    |                          Name                           |   Type   | Access privileges | Column privileges | Policies
-----------+---------------------------------------------------------+----------+-------------------+-------------------+----------
 my_scheme | access_roles                                            | table    |                   |                   |
 my_scheme | access_roles_ar_id_seq                                  | sequence |                   |                   |
</code></pre>
<h2 id="list-tables" tabindex="-1">List Tables <a class="header-anchor" href="#list-tables" aria-hidden="true">🔗</a></h2>
<pre><code class="language-bash">$ <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -p 5432 -h localhost -U user_reader
mydb=&gt;    SELECT * FROM pg_catalog.pg_tables WHERE schemaname NOT IN(<span class="hljs-string">&#x27;pg_catalog&#x27;</span>, <span class="hljs-string">&#x27;information_schema&#x27;</span>);
mydb=&gt;    SELECT schema_name, schema_owner FROM information_schema.schemata;

[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb --pset=<span class="hljs-string">&quot;pager=off&quot;</span> --pset=<span class="hljs-string">&quot;footer=off&quot;</span> -c <span class="hljs-string">&quot;\dt my_scheme.*&quot;</span>
[root@postgresqlhost ~]# <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb --pset=<span class="hljs-string">&quot;pager=off&quot;</span> --pset=<span class="hljs-string">&quot;footer=off&quot;</span> -c <span class="hljs-string">&quot;SELECT org_id, org_name, org_enabled FROM my_scheme.mytable;&quot;</span>
</code></pre>
<pre><code> org_id |  org_name   | org_enabled
--------+-------------+-------------
    201 | _SVI        | t
    203 | _TEST       | t
    202 | _COLL       | t
</code></pre>
<h2 id="schemaspy" tabindex="-1">SchemaSpy <a class="header-anchor" href="#schemaspy" aria-hidden="true">🔗</a></h2>
<p>Verifica che l'utente user_reader possa leggere gli schemi di metadati <code>pg_catalog</code> e <code>information_schema</code>:</p>
<pre><code class="language-bat"><span class="hljs-function">C:\&gt; <span class="hljs-title">ssh</span> -<span class="hljs-title">m</span> <span class="hljs-title">hmac</span>-<span class="hljs-title">sha2</span>-512 <span class="hljs-title">root</span>@<span class="hljs-title">postgresqlhost</span> #  <span class="hljs-title">Server</span> 
<span class="hljs-title">C</span>:\&gt; <span class="hljs-title">ssh</span> -<span class="hljs-title">m</span> <span class="hljs-title">hmac</span>-<span class="hljs-title">sha2</span>-512 -<span class="hljs-title">L</span> 5432:<span class="hljs-title">localhost</span>:5432 <span class="hljs-title">postgresqlhost</span># <span class="hljs-title">Tunnel</span> <span class="hljs-title">SSH</span>
</span></code></pre>
<pre><code class="language-bash">$ <span class="hljs-built_in">sudo</span> -Hiu postgres psql mydb -p 5432 -h localhost -U user_reader
mydb=&gt;    SELECT * FROM pg_catalog.pg_tables WHERE schemaname NOT IN(<span class="hljs-string">&#x27;pg_catalog&#x27;</span>, <span class="hljs-string">&#x27;information_schema&#x27;</span>);
mydb=&gt;    SELECT schema_name, schema_owner FROM information_schema.schemata;
</code></pre>
<ul>
<li>
<p><a href="https://schemaspy.org/">https://schemaspy.org/</a></p>
</li>
<li>
<p><a href="https://github.com/schemaspy/schemaspy">https://github.com/schemaspy/schemaspy</a></p>
</li>
<li>
<p><a href="https://jdbc.postgresql.org/download/">https://jdbc.postgresql.org/download/</a></p>
</li>
<li>
<p><a href="https://schemaspy.readthedocs.io/en/latest/">https://schemaspy.readthedocs.io/en/latest/</a></p>
</li>
<li>
<p><a href="https://schemaspy.readthedocs.io/en/latest/installation.html">https://schemaspy.readthedocs.io/en/latest/installation.html</a>
For SchemaSpy version 6.1.0 or higher, simply include <code>-vizjs</code> as a command line argument when executing the SchemaSpy command.</p>
</li>
<li>
<p><a href="https://schemaspy.readthedocs.io/en/latest/configuration/commandline.html">https://schemaspy.readthedocs.io/en/latest/configuration/commandline.html</a></p>
</li>
<li>
<p><a href="https://schemaspy.readthedocs.io/en/latest/configuration/databaseType.html#included">https://schemaspy.readthedocs.io/en/latest/configuration/databaseType.html#included</a></p>
</li>
</ul>
<pre><code class="language-bash">curl --<span class="hljs-built_in">help</span>
curl -L https://github.com/schemaspy/schemaspy/releases/download/v6.2.4/schemaspy-6.2.4.jar --output ./schemaspy.jar
curl -L https://jdbc.postgresql.org/download/postgresql-42.7.3.jar --output ./jdbc-driver.jar
</code></pre>
<ul>
<li>
<p><a href="https://github.com/schemaspy/schemaspy/issues/462">https://github.com/schemaspy/schemaspy/issues/462</a> Large database causes stackoverflow when usig viz.js</p>
<pre><code>  Caused by: org.schemaspy.output.diagram.RenderException: javax.script.ScriptException: java.lang.StackOverflowError in &lt;eval&gt; at line number 27 at column number 596797
          at org.schemaspy.output.diagram.vizjs.VizJSDot.render(VizJSDot.java:74)
          at org.schemaspy.output.diagram.TableDiagram.generateTableDiagram(TableDiagram.java:21)

  Soluzione ==&gt; -Xss32m 
</code></pre>
</li>
</ul>
<pre><code class="language-bat"><span class="hljs-comment">    rem Prima far partire il tunnel SSH ssh -L 5432:localhost:5432 postgresqlhost</span>
    @<span class="hljs-built_in">ECHO</span> off
<span class="hljs-comment">    rem msdos string substitution:</span>
<span class="hljs-comment">    rem %0 è il nome del presente file</span>
<span class="hljs-comment">    rem ~ string substitution</span>
<span class="hljs-comment">    rem d: drive letter</span>
<span class="hljs-comment">    rem p full file path</span>
    <span class="hljs-built_in">CD</span> /d %~dp0
    <span class="hljs-built_in">SET</span> OUT_DIR=report
    <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXIST</span> <span class="hljs-variable">%OUT_DIR%</span>\ <span class="hljs-built_in">RD</span> /s /q <span class="hljs-variable">%OUT_DIR%</span>
    <span class="hljs-built_in">MKDIR</span> <span class="hljs-variable">%OUT_DIR%</span>
    <span class="hljs-built_in">SET</span> <span class="hljs-built_in">PATH</span>=<span class="hljs-variable">%ProgramFiles%</span>\Java\OpenJavaDevKit21\bin;<span class="hljs-variable">%PATH%</span>
    java -Xss32m ^
        -jar ./schemaspy-<span class="hljs-number">6</span>.<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.jar ^
        -t pgsql11 ^
        -vizjs ^
        -dp ./postgresql-<span class="hljs-number">42</span>.<span class="hljs-number">7</span>.<span class="hljs-number">3</span>.jar ^
        -db mydb ^
        -s my_scheme ^
        -host localhost ^
        -port <span class="hljs-number">5432</span> ^
        -u user_reader ^
        -p password ^
        -o ./<span class="hljs-variable">%OUT_DIR%</span>
        
    <span class="hljs-built_in">pause</span>
</code></pre>
<p>Wrote relationship details of 587 tables/views to directory <code>.\report</code> in 3178 seconds.
View the results by opening <code>.\report\index.html</code></p>
<h2 id="export-dello-schema-del-db" tabindex="-1">Export dello Schema del DB <a class="header-anchor" href="#export-dello-schema-del-db" aria-hidden="true">🔗</a></h2>
<pre><code class="language-bat"><span class="hljs-function">C:\&gt; <span class="hljs-title">ssh</span> -<span class="hljs-title">m</span> <span class="hljs-title">hmac</span>-<span class="hljs-title">sha2</span>-512 <span class="hljs-title">root</span>@<span class="hljs-title">postgresqlhost</span> #  <span class="hljs-title">Server</span> 
</span></code></pre>
<pre><code class="language-bash">[root@postgresqlhost ~]# <span class="hljs-built_in">which</span> pg_dump
/usr/bin/pg_dump
[root@postgresqlhost ~]# ll /usr/bin/pg_dump
lrwxrwxrwx. 1 root root 31 Jul  8  2022 /usr/bin/pg_dump -&gt; /etc/alternatives/pgsql-pg_dump

$ <span class="hljs-built_in">sudo</span> -Hiu postgres /usr/bin/pg_dump --<span class="hljs-built_in">help</span>
$ <span class="hljs-built_in">sudo</span> -Hiu postgres /usr/bin/pg_dump -v
$ <span class="hljs-built_in">sudo</span> -Hiu postgres /usr/bin/pg_dump -s -n my_scheme -f /tmp/mydb_my_scheme_schema.sql mydb

</code></pre>
<h2 id="test-connessione-a-postgresql" tabindex="-1">Test connessione a PostgreSQL <a class="header-anchor" href="#test-connessione-a-postgresql" aria-hidden="true">🔗</a></h2>
<pre><code class="language-bat"><span class="hljs-function">C:\&gt; <span class="hljs-title">ssh</span> -<span class="hljs-title">m</span> <span class="hljs-title">hmac</span>-<span class="hljs-title">sha2</span>-512 <span class="hljs-title">user</span>@<span class="hljs-title">postgresqlhost</span> #  <span class="hljs-title">Server</span> 
</span></code></pre>
<pre><code class="language-bash"><span class="hljs-built_in">sudo</span> -Hiu postgres PGPASSWORD=password psql mydb -p 5432 -h localhost -U user_reader -c <span class="hljs-string">&quot;SELECT org_id, org_name, org_enabled FROM myscheme.mytable&quot;</span>
</code></pre>
<h2 id="primi-passi-in-manjaro" tabindex="-1">Primi Passi in Manjaro <a class="header-anchor" href="#primi-passi-in-manjaro" aria-hidden="true">🔗</a></h2>
<ul>
<li><a href="https://wiki.archlinux.org/title/PostgreSQL">https://wiki.archlinux.org/title/PostgreSQL</a></li>
<li><a href="https://scrivocodice.it/installare-postgresql-manjaro/">https://scrivocodice.it/installare-postgresql-manjaro/</a></li>
<li><a href="https://www3.ntu.edu.sg/home/ehchua/programming/sql/PostgreSQL_GetStarted.html">https://www3.ntu.edu.sg/home/ehchua/programming/sql/PostgreSQL_GetStarted.html</a></li>
<li><a href="https://www.geeksforgeeks.org/how-to-install-postgresql-on-arch-based-linux-distributions-manjaro/">https://www.geeksforgeeks.org/how-to-install-postgresql-on-arch-based-linux-distributions-manjaro/</a></li>
</ul>
<pre><code class="language-sql">$ sudo pacman <span class="hljs-operator">-</span>Syu <span class="hljs-comment">--needed --noconfirm postgresql</span>
$ postgres <span class="hljs-comment">--version</span>
$ whereis postgresql
$ which psql     # psql <span class="hljs-keyword">is</span> an interactive PostgreSQL client

$ sudo passwd postgres
$ sudo su postgres <span class="hljs-operator">-</span>l # alternativamente puoi usare sudo <span class="hljs-operator">-</span>u postgres <span class="hljs-operator">-</span>i

$ sudo <span class="hljs-operator">-</span>iu postgres
$ initdb <span class="hljs-comment">--locale $LANG -E UTF8 -D &#x27;/var/lib/postgres/data/&#x27;</span>
$ exit

$ sudo systemctl <span class="hljs-keyword">start</span> postgresql
$ sudo systemctl status postgresql
$ sudo systemctl enable <span class="hljs-comment">--now postgresql.service</span>

$ sudo su <span class="hljs-operator">-</span> postgres
$ createuser <span class="hljs-operator">-</span>d pippo
#  <span class="hljs-operator">-</span>d: <span class="hljs-keyword">per</span> abilitare l<span class="hljs-string">&#x27;utente a creare database
#  -s: per associare all&#x27;</span>utente un ruolo da superuser
$ createdb myDatabaseName
$ psql <span class="hljs-operator">-</span>d myDatabaseName

$ sudo su <span class="hljs-operator">-</span> postgres psql
# <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> new_user <span class="hljs-keyword">WITH</span> ENCRYPTED PASSWORD <span class="hljs-string">&#x27;newpass&#x27;</span>;
# <span class="hljs-keyword">CREATE</span> DATABASE new_db;
# <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> DATABASE new_db <span class="hljs-keyword">TO</span> new_user;

# Uninstall
$ sudo pacman <span class="hljs-operator">-</span>Rcns postgresql

$ locate postgresql.conf

$ sudo systemctl <span class="hljs-keyword">start</span> postgresql
$ sudo systemctl stop postgresql
$ sudo systemctl restart postgresql
$ sudo systemctl reload postgresql
$ sudo systemctl status postgresql   <span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-keyword">Show</span> th status
$ ps aux <span class="hljs-operator">|</span> grep postgres

$ sudo <span class="hljs-operator">-</span>u postgres psql
   <span class="hljs-comment">-- Run command &quot;psql&quot; as UNIX USER &quot;postgres&quot;.</span>
   <span class="hljs-comment">-- Enter the CURRENT SUPERUSER password for sudo.</span>
psql (<span class="hljs-number">10.6</span> (Ubuntu <span class="hljs-number">10.6</span><span class="hljs-number">-0</span>ubuntu0<span class="hljs-number">.18</span><span class="hljs-number">.04</span><span class="hljs-number">.1</span>))
Type &quot;help&quot; <span class="hljs-keyword">for</span> help.
postgres<span class="hljs-operator">=</span># help 
You <span class="hljs-keyword">are</span> <span class="hljs-keyword">using</span> psql, the command<span class="hljs-operator">-</span>line interface <span class="hljs-keyword">to</span> PostgreSQL.
Type:  \copyright <span class="hljs-keyword">for</span> distribution terms
       \h <span class="hljs-keyword">for</span> help <span class="hljs-keyword">with</span> <span class="hljs-keyword">SQL</span> commands
       \? <span class="hljs-keyword">for</span> help <span class="hljs-keyword">with</span> psql commands
       \g <span class="hljs-keyword">or</span> terminate <span class="hljs-keyword">with</span> semicolon <span class="hljs-keyword">to</span> <span class="hljs-keyword">execute</span> query
       \q <span class="hljs-keyword">to</span> quit
<span class="hljs-comment">-- Display version</span>
postgres<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> version();
     version                                                   
<span class="hljs-comment">---------------------------------------------------</span>
 PostgreSQL <span class="hljs-number">10.6</span> (Ubuntu <span class="hljs-number">10.6</span><span class="hljs-number">-0</span>ubuntu0<span class="hljs-number">.18</span><span class="hljs-number">.04</span><span class="hljs-number">.1</span>) ...
press q <span class="hljs-keyword">to</span> quit display
<span class="hljs-comment">-- Quit</span>
postgres<span class="hljs-operator">=</span># \q

<span class="hljs-comment">-- Login to server</span>
$ sudo <span class="hljs-operator">-</span>u postgres psql
......
<span class="hljs-comment">-- List all databases via \l (or \list), or \l+ for more details</span>
postgres<span class="hljs-operator">=</span># \l
   Name    <span class="hljs-operator">|</span> ...
<span class="hljs-comment">-----------+-----------</span>
postgres   <span class="hljs-operator">|</span> ...
template0  <span class="hljs-operator">|</span> ...
template1  <span class="hljs-operator">|</span> ...
<span class="hljs-comment">-- Help on SQL command syntax</span>
postgres<span class="hljs-operator">=</span># \h <span class="hljs-keyword">CREATE</span> DATABASE
......
<span class="hljs-comment">-- Create a new database called mytest</span>
postgres<span class="hljs-operator">=</span># <span class="hljs-keyword">CREATE</span> DATABASE mytest;
<span class="hljs-keyword">CREATE</span> DATABASE
   <span class="hljs-comment">-- By default, the owner of the database is the current login user.</span>
<span class="hljs-comment">-- List all databases via \l (or \list), or \l+ for more details</span>
postgres<span class="hljs-operator">=</span># \l
                                  List <span class="hljs-keyword">of</span> databases
   Name    <span class="hljs-operator">|</span>  Owner   <span class="hljs-operator">|</span> Encoding <span class="hljs-operator">|</span>   <span class="hljs-keyword">Collate</span>   <span class="hljs-operator">|</span>    Ctype    <span class="hljs-operator">|</span>   Access privileges   
<span class="hljs-comment">-----------+----------+----------+-------------+-------------+-----------------------</span>
 mytest    <span class="hljs-operator">|</span> postgres <span class="hljs-operator">|</span> UTF8     <span class="hljs-operator">|</span> en_US.UTF<span class="hljs-number">-8</span> <span class="hljs-operator">|</span> en_US.UTF<span class="hljs-number">-8</span> <span class="hljs-operator">|</span>
 ......
   <span class="hljs-comment">-- By default, CREATE DATABASE copies the &quot;template1&quot;, which you could customize.</span>
   <span class="hljs-comment">-- &quot;template0&quot; has the same contents as &quot;template1&quot;, but you should not change.</span>
<span class="hljs-comment">-- Connect to mytest database via \c (or \connect)</span>
<span class="hljs-comment">-- Take note of the change of database name in the command prompt.</span>
postgres<span class="hljs-operator">=</span># \c mytest 
You <span class="hljs-keyword">are</span> now connected <span class="hljs-keyword">to</span> database &quot;mytest&quot; <span class="hljs-keyword">as</span> <span class="hljs-keyword">user</span> &quot;postgres&quot;.
<span class="hljs-comment">-- Display all tables (aka relations) via \dt or \dt+ for more details</span>
mytest<span class="hljs-operator">=</span># \dt
Did <span class="hljs-keyword">not</span> find <span class="hljs-keyword">any</span> relations.
<span class="hljs-comment">-- We will be using an enumeration (TYPE) in our table, let&#x27;s define it.</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">CREATE</span> TYPE cat_enum <span class="hljs-keyword">AS</span> ENUM (<span class="hljs-string">&#x27;coffee&#x27;</span>, <span class="hljs-string">&#x27;tea&#x27;</span>);
<span class="hljs-keyword">CREATE</span> TYPE
<span class="hljs-comment">-- Display all types via /dT or /dT+ for more details.</span>
mytest<span class="hljs-operator">=</span># \dT<span class="hljs-operator">+</span>
                        List <span class="hljs-keyword">of</span> data types
 Schema <span class="hljs-operator">|</span>   Name   <span class="hljs-operator">|</span> Internal name <span class="hljs-operator">|</span> Size <span class="hljs-operator">|</span> Elements <span class="hljs-operator">|</span> Description 
<span class="hljs-comment">--------+----------+---------------+------+----------+-------------</span>
 public <span class="hljs-operator">|</span> cat_enum <span class="hljs-operator">|</span> cat_enum      <span class="hljs-operator">|</span> <span class="hljs-number">4</span>    <span class="hljs-operator">|</span> coffee  <span class="hljs-operator">+</span><span class="hljs-operator">|</span> 
        <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span>               <span class="hljs-operator">|</span>      <span class="hljs-operator">|</span> tea      <span class="hljs-operator">|</span> 
<span class="hljs-comment">-- Create a new table.</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> cafe (
  id SERIAL <span class="hljs-keyword">PRIMARY</span> KEY,        <span class="hljs-comment">-- AUTO_INCREMENT integer, as primary key</span>
  category cat_enum <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,   <span class="hljs-comment">-- Use the enum type defined earlier</span>
  name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,    <span class="hljs-comment">-- Variable-length string of up to 50 characters</span>
  price <span class="hljs-type">NUMERIC</span>(<span class="hljs-number">5</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,  <span class="hljs-comment">-- 5 digits total, with 2 decimal places</span>
  last_update <span class="hljs-type">DATE</span>              <span class="hljs-comment">-- &#x27;YYYY-MM-DD&#x27;</span>
);
NOTICE:  <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> will <span class="hljs-keyword">create</span> implicit sequence &quot;cafe_id_seq&quot; <span class="hljs-keyword">for</span> serial <span class="hljs-keyword">column</span> &quot;cafe.id&quot;
NOTICE:  <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-operator">/</span> <span class="hljs-keyword">PRIMARY</span> KEY will <span class="hljs-keyword">create</span> implicit index &quot;cafe_pkey&quot; <span class="hljs-keyword">for</span> <span class="hljs-keyword">table</span> &quot;cafe&quot;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span>
<span class="hljs-comment">-- Display all tables in the current database, via \dt or \dt+ for more details</span>
mytest<span class="hljs-operator">=</span># \dt<span class="hljs-operator">+</span>
                    List <span class="hljs-keyword">of</span> relations
 Schema <span class="hljs-operator">|</span> Name <span class="hljs-operator">|</span> Type  <span class="hljs-operator">|</span>  Owner   <span class="hljs-operator">|</span>  Size   <span class="hljs-operator">|</span> Description 
<span class="hljs-comment">--------+------+-------+----------+---------+-------------</span>
 public <span class="hljs-operator">|</span> cafe <span class="hljs-operator">|</span> <span class="hljs-keyword">table</span> <span class="hljs-operator">|</span> postgres <span class="hljs-operator">|</span> <span class="hljs-number">0</span> bytes <span class="hljs-operator">|</span> 
<span class="hljs-comment">-- Display details of a particular table.</span>
mytest<span class="hljs-operator">=</span># \d<span class="hljs-operator">+</span> cafe
                                               <span class="hljs-keyword">Table</span> &quot;public.cafe&quot;
   <span class="hljs-keyword">Column</span>    <span class="hljs-operator">|</span>         Type          <span class="hljs-operator">|</span>                     Modifiers                     <span class="hljs-operator">|</span> Storage  <span class="hljs-operator">|</span> Description 
<span class="hljs-comment">-------------+-----------------------+---------------------------------------------------+----------+-------------</span>
 id          <span class="hljs-operator">|</span> <span class="hljs-type">integer</span>               <span class="hljs-operator">|</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">default</span> nextval(<span class="hljs-string">&#x27;cafe_id_seq&#x27;</span>::regclass) <span class="hljs-operator">|</span> plain    <span class="hljs-operator">|</span> 
 category    <span class="hljs-operator">|</span> cat_enum              <span class="hljs-operator">|</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>                                          <span class="hljs-operator">|</span> plain    <span class="hljs-operator">|</span> 
 name        <span class="hljs-operator">|</span> <span class="hljs-type">character</span> <span class="hljs-type">varying</span>(<span class="hljs-number">50</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>                                          <span class="hljs-operator">|</span> extended <span class="hljs-operator">|</span> 
 price       <span class="hljs-operator">|</span> <span class="hljs-type">numeric</span>(<span class="hljs-number">5</span>,<span class="hljs-number">2</span>)          <span class="hljs-operator">|</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>                                          <span class="hljs-operator">|</span> main     <span class="hljs-operator">|</span> 
 last_update <span class="hljs-operator">|</span> <span class="hljs-type">date</span>                  <span class="hljs-operator">|</span>                                                   <span class="hljs-operator">|</span> plain    <span class="hljs-operator">|</span> 
Indexes:
    &quot;cafe_pkey&quot; <span class="hljs-keyword">PRIMARY</span> KEY, btree (id)
Has OIDs: <span class="hljs-keyword">no</span>
<span class="hljs-comment">-- Insert rows.</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> cafe (category, name, price) <span class="hljs-keyword">VALUES</span>
  (<span class="hljs-string">&#x27;coffee&#x27;</span>, <span class="hljs-string">&#x27;Espresso&#x27;</span>, <span class="hljs-number">3.19</span>),
  (<span class="hljs-string">&#x27;coffee&#x27;</span>, <span class="hljs-string">&#x27;Cappuccino&#x27;</span>, <span class="hljs-number">3.29</span>),
  (<span class="hljs-string">&#x27;coffee&#x27;</span>, <span class="hljs-string">&#x27;Caffe Latte&#x27;</span>, <span class="hljs-number">3.39</span>),
  (<span class="hljs-string">&#x27;coffee&#x27;</span>, <span class="hljs-string">&#x27;Caffe Mocha&#x27;</span>, <span class="hljs-number">3.49</span>),
  (<span class="hljs-string">&#x27;coffee&#x27;</span>, <span class="hljs-string">&#x27;Brewed Coffee&#x27;</span>, <span class="hljs-number">3.59</span>),
  (<span class="hljs-string">&#x27;tea&#x27;</span>, <span class="hljs-string">&#x27;Green Tea&#x27;</span>, <span class="hljs-number">2.99</span>),
  (<span class="hljs-string">&#x27;tea&#x27;</span>, <span class="hljs-string">&#x27;Wulong Tea&#x27;</span>, <span class="hljs-number">2.89</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-number">0</span> <span class="hljs-number">7</span>
<span class="hljs-comment">-- The output shows the OID (Object Identification Number) and the rows affected.</span>
<span class="hljs-comment">-- Each row has an hidden OID. OID is not a standard SQL feature and not recommended.</span>
<span class="hljs-comment">-- Query (SELECT)</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cafe;
 id <span class="hljs-operator">|</span> category <span class="hljs-operator">|</span>     name      <span class="hljs-operator">|</span> price <span class="hljs-operator">|</span> last_update 
<span class="hljs-comment">----+----------+---------------+-------+-------------</span>
  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> coffee   <span class="hljs-operator">|</span> Espresso      <span class="hljs-operator">|</span>  <span class="hljs-number">3.19</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> coffee   <span class="hljs-operator">|</span> Cappuccino    <span class="hljs-operator">|</span>  <span class="hljs-number">3.29</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">3</span> <span class="hljs-operator">|</span> coffee   <span class="hljs-operator">|</span> Caffe Latte   <span class="hljs-operator">|</span>  <span class="hljs-number">3.39</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> coffee   <span class="hljs-operator">|</span> Caffe Mocha   <span class="hljs-operator">|</span>  <span class="hljs-number">3.49</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> coffee   <span class="hljs-operator">|</span> Brewed Coffee <span class="hljs-operator">|</span>  <span class="hljs-number">3.59</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> tea      <span class="hljs-operator">|</span> Green Tea     <span class="hljs-operator">|</span>  <span class="hljs-number">2.99</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">7</span> <span class="hljs-operator">|</span> tea      <span class="hljs-operator">|</span> Wulong Tea    <span class="hljs-operator">|</span>  <span class="hljs-number">2.89</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
(<span class="hljs-number">7</span> <span class="hljs-keyword">rows</span>)
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> name, price <span class="hljs-keyword">FROM</span> cafe <span class="hljs-keyword">WHERE</span> category <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;coffee&#x27;</span> <span class="hljs-keyword">AND</span> price <span class="hljs-operator">&lt;</span> <span class="hljs-number">3.3</span>; 
    name    <span class="hljs-operator">|</span> price 
<span class="hljs-comment">------------+-------</span>
 Espresso   <span class="hljs-operator">|</span>  <span class="hljs-number">3.19</span>
 Cappuccino <span class="hljs-operator">|</span>  <span class="hljs-number">3.29</span>
(<span class="hljs-number">2</span> <span class="hljs-keyword">rows</span>)
<span class="hljs-comment">-- Update</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">UPDATE</span> cafe <span class="hljs-keyword">SET</span> price <span class="hljs-operator">=</span> price <span class="hljs-operator">*</span> <span class="hljs-number">1.1</span> <span class="hljs-keyword">WHERE</span> category <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;tea&#x27;</span>;
<span class="hljs-keyword">UPDATE</span> <span class="hljs-number">2</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cafe <span class="hljs-keyword">WHERE</span> category <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;tea&#x27;</span>;
 id <span class="hljs-operator">|</span> category <span class="hljs-operator">|</span>    name    <span class="hljs-operator">|</span> price <span class="hljs-operator">|</span> last_update 
<span class="hljs-comment">----+----------+------------+-------+-------------</span>
  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> tea      <span class="hljs-operator">|</span> Green Tea  <span class="hljs-operator">|</span>  <span class="hljs-number">3.29</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
  <span class="hljs-number">7</span> <span class="hljs-operator">|</span> tea      <span class="hljs-operator">|</span> Wulong Tea <span class="hljs-operator">|</span>  <span class="hljs-number">3.18</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
(<span class="hljs-number">2</span> <span class="hljs-keyword">rows</span>)
<span class="hljs-comment">-- Delete</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> cafe <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;
<span class="hljs-keyword">DELETE</span> <span class="hljs-number">1</span>
mytest<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cafe <span class="hljs-keyword">WHERE</span> category <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;tea&#x27;</span>;
 id <span class="hljs-operator">|</span> category <span class="hljs-operator">|</span>    name    <span class="hljs-operator">|</span> price <span class="hljs-operator">|</span> last_update 
<span class="hljs-comment">----+----------+------------+-------+-------------</span>
  <span class="hljs-number">7</span> <span class="hljs-operator">|</span> tea      <span class="hljs-operator">|</span> Wulong Tea <span class="hljs-operator">|</span>  <span class="hljs-number">3.18</span> <span class="hljs-operator">|</span> <span class="hljs-number">2013</span><span class="hljs-number">-12</span><span class="hljs-number">-14</span>
(<span class="hljs-number">1</span> <span class="hljs-type">row</span>)
<span class="hljs-comment">-- Quit</span>
mytest<span class="hljs-operator">=</span># \q


# <span class="hljs-keyword">Create</span> a <span class="hljs-keyword">new</span> PostgreSQL <span class="hljs-keyword">user</span> <span class="hljs-keyword">called</span> testuser, allow <span class="hljs-keyword">user</span> <span class="hljs-keyword">to</span> login, but <span class="hljs-keyword">NOT</span> creating databases
$ sudo <span class="hljs-operator">-</span>u postgres createuser <span class="hljs-comment">--login --pwprompt testuser</span>
Enter password <span class="hljs-keyword">for</span> <span class="hljs-keyword">new</span> role: xxxx
# <span class="hljs-keyword">Create</span> a <span class="hljs-keyword">new</span> database <span class="hljs-keyword">called</span> testdb, owned <span class="hljs-keyword">by</span> testuser.
$ sudo <span class="hljs-operator">-</span>u postgres createdb <span class="hljs-comment">--owner=testuser testdb</span>
$ sudo service postgresql restart

# Login <span class="hljs-keyword">to</span> PostgreSQL: psql <span class="hljs-operator">-</span>U <span class="hljs-keyword">user</span> database
$ psql <span class="hljs-operator">-</span>U testuser testdb
Password <span class="hljs-keyword">for</span> <span class="hljs-keyword">user</span> testuser: ......
psql (<span class="hljs-number">9.3</span><span class="hljs-number">.10</span>)
Type &quot;help&quot; <span class="hljs-keyword">for</span> help.
# List <span class="hljs-keyword">all</span> databases (\list <span class="hljs-keyword">or</span> \l)
testdb<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span>\list
   Name    <span class="hljs-operator">|</span>  Owner   <span class="hljs-operator">|</span> Encoding <span class="hljs-operator">|</span>   <span class="hljs-keyword">Collate</span>   <span class="hljs-operator">|</span>    Ctype    <span class="hljs-operator">|</span>   Access privileges   
<span class="hljs-comment">-----------+----------+----------+-------------+-------------+-----------------------</span>
 testdb    <span class="hljs-operator">|</span> testuser <span class="hljs-operator">|</span> UTF8     <span class="hljs-operator">|</span> en_SG.UTF<span class="hljs-number">-8</span> <span class="hljs-operator">|</span> en_SG.UTF<span class="hljs-number">-8</span> <span class="hljs-operator">|</span>
......
# <span class="hljs-keyword">Create</span> <span class="hljs-keyword">table</span>
testdb<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> cafe (
           name <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>),
           price <span class="hljs-type">numeric</span>(<span class="hljs-number">5</span>,<span class="hljs-number">2</span>),
           <span class="hljs-keyword">primary</span> key (name));
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span>
# <span class="hljs-keyword">Insert</span> <span class="hljs-keyword">rows</span>
testdb<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> cafe <span class="hljs-keyword">values</span>
           (<span class="hljs-string">&#x27;Espresso&#x27;</span>, <span class="hljs-number">3.99</span>),
           (<span class="hljs-string">&#x27;Green Tea&#x27;</span>, <span class="hljs-number">2.99</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span>
# <span class="hljs-keyword">Select</span> query
testdb<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> cafe;
   name    <span class="hljs-operator">|</span> price 
<span class="hljs-comment">-----------+-------</span>
 Espresso  <span class="hljs-operator">|</span>  <span class="hljs-number">3.99</span>
 Green Tea <span class="hljs-operator">|</span>  <span class="hljs-number">2.99</span>
(<span class="hljs-number">2</span> <span class="hljs-keyword">rows</span>)
# <span class="hljs-keyword">To</span> change password <span class="hljs-keyword">for</span> the <span class="hljs-keyword">current</span> <span class="hljs-keyword">user</span>
testdb<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> \password
......
testdb<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> \q


<span class="hljs-comment">-- Login in to server via &quot;psql&quot; with user &quot;postgres&quot;</span>
$ sudo <span class="hljs-operator">-</span>u postgres psql
......
<span class="hljs-comment">-- Change password for current user &quot;postgres&quot;</span>
postgres<span class="hljs-operator">=</span># \password postgres
Enter <span class="hljs-keyword">new</span> password: xxxx
Enter it again: xxxx
<span class="hljs-comment">-- Display the user table</span>
postgres<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> pg_user;
 usename  <span class="hljs-operator">|</span> usesysid <span class="hljs-operator">|</span> usecreatedb <span class="hljs-operator">|</span> usesuper <span class="hljs-operator">|</span> usecatupd <span class="hljs-operator">|</span> userepl <span class="hljs-operator">|</span>  passwd  <span class="hljs-operator">|</span> valuntil <span class="hljs-operator">|</span> useconfig 
<span class="hljs-comment">----------+----------+-------------+----------+-----------+---------+----------+----------+-----------</span>
 postgres <span class="hljs-operator">|</span>       <span class="hljs-number">10</span> <span class="hljs-operator">|</span> t           <span class="hljs-operator">|</span> t        <span class="hljs-operator">|</span> t         <span class="hljs-operator">|</span> t       <span class="hljs-operator">|</span> <span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span> <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span>
<span class="hljs-comment">-- Quit</span>
postgres<span class="hljs-operator">=</span># \q
<span class="hljs-comment">-- Switch to default superuser &quot;postgres&quot;,</span>
<span class="hljs-comment">-- run utility &quot;createuser&quot; to create a superuser same name as current login.</span>
<span class="hljs-comment">-- &quot;$USER&quot; is an environment variable denoting the current login user.</span>
$ sudo <span class="hljs-operator">-</span>u postgres createuser <span class="hljs-comment">--superuser $USER</span>
<span class="hljs-comment">-- Create the default database which shall be the same as the username.</span>
$ sudo <span class="hljs-operator">-</span>u postgres createdb $<span class="hljs-keyword">USER</span>
<span class="hljs-comment">-- Now, you can invoke &quot;psql&quot; from your user account.</span>
$ psql
......
yourusername<span class="hljs-operator">=</span># <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> pg_user;
   usename    <span class="hljs-operator">|</span> usesysid <span class="hljs-operator">|</span> usecreatedb <span class="hljs-operator">|</span> usesuper <span class="hljs-operator">|</span> usecatupd <span class="hljs-operator">|</span> userepl <span class="hljs-operator">|</span>  passwd  <span class="hljs-operator">|</span> valuntil <span class="hljs-operator">|</span> useconfig 
<span class="hljs-comment">--------------+----------+-------------+----------+-----------+---------+----------+----------+-----------</span>
 yourusername <span class="hljs-operator">|</span>    <span class="hljs-number">16424</span> <span class="hljs-operator">|</span> t           <span class="hljs-operator">|</span> t        <span class="hljs-operator">|</span> t         <span class="hljs-operator">|</span> t       <span class="hljs-operator">|</span> <span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span> <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span>            
 

<span class="hljs-comment">-- Create a login user role</span>
<span class="hljs-keyword">CREATE</span> ROLE user1 LOGIN PASSWORD <span class="hljs-string">&#x27;xxxx&#x27;</span> CREATEDB VALID UNTIL <span class="hljs-string">&#x27;infinity&#x27;</span>;
<span class="hljs-comment">-- Create a login superuser role</span>
<span class="hljs-keyword">CREATE</span> ROLE user2 LOGIN PASSWORD <span class="hljs-string">&#x27;xxxx&#x27;</span> SUPERUSER VALID UNTIL <span class="hljs-string">&#x27;2019-12-31&#x27;</span>;
<span class="hljs-comment">-- Create a group role</span>
<span class="hljs-keyword">CREATE</span> ROLE group1 INHERIT;
<span class="hljs-comment">-- Add a user (or group) to this group</span>
<span class="hljs-keyword">GRANT</span> group1 <span class="hljs-keyword">TO</span> user1;


<span class="hljs-comment">-- Create a compressed backup for a database</span>
pg_dump <span class="hljs-operator">-</span>h localhost <span class="hljs-operator">-</span>p <span class="hljs-number">5432</span> <span class="hljs-operator">-</span>U username <span class="hljs-operator">-</span>F c <span class="hljs-operator">-</span>b <span class="hljs-operator">-</span>v <span class="hljs-operator">-</span>f mydatabase.backup mydatabase
<span class="hljs-comment">-- Create a plain-text backup for a database, including the CREATE DATABASE</span>
pg_dump <span class="hljs-operator">-</span>h localhost <span class="hljs-operator">-</span>p <span class="hljs-number">5432</span> <span class="hljs-operator">-</span>U username <span class="hljs-operator">-</span>C <span class="hljs-operator">-</span>F p <span class="hljs-operator">-</span>b <span class="hljs-operator">-</span>v <span class="hljs-operator">-</span>f mydatabase.backup.sql mydatabase

<span class="hljs-keyword">To</span> restore a database <span class="hljs-keyword">from</span> backup generated <span class="hljs-keyword">by</span> pg_dump <span class="hljs-keyword">or</span> pg_dumpall:

<span class="hljs-number">1.</span>  Use &quot;psql&quot; <span class="hljs-keyword">to</span> run the plain<span class="hljs-operator">-</span>text backup.

    <span class="hljs-comment">-- Run SQL script</span>
    $ psql <span class="hljs-operator">-</span>U username <span class="hljs-operator">-</span>f filename.sql

<span class="hljs-number">2.</span>  Use utility &quot;pg_restore&quot; <span class="hljs-keyword">to</span> restore compressed backup.

</code></pre>
</body></html>